webpackJsonp([1],{"+H6j":function(t,e){},"/EJr":function(t,e){},"1V3h":function(t,e){},"74p7":function(t,e){},GoAp:function(t,e){},IrNe:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),i=s("NYxO"),n={state:{isLogin:!1,id:0,userType:0,username:"游客",avatar:"default_avatar.png"},getters:{isLogin:function(t){return t.isLogin},id:function(t){return t.id},userType:function(t){return t.userType},username:function(t){return t.username},avatar:function(t){return t.avatar}},actions:{},mutations:{login:function(t,e){t.isLogin=!0,t.id=e.userId,t.userType=e.userType,t.username=e.username,t.avatar=e.avatar},logout:function(t){t.isLogin=!1},changeAvatar:function(t,e){t.avatar=e}}};a.default.use(i.a);var r=new i.a.Store({modules:{User:n}}),o={name:"App",store:r,data:function(){return{}},methods:{}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{staticClass:"main-view"})],1)},staticRenderFns:[]};var c=s("VU/8")(o,l,!1,function(t){s("PyXk")},null,null).exports,u=s("/ocq"),d={name:"login",beforeRouteUpdate:function(t,e,s){console.log("here"),s()}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login"},[e("div",{staticClass:"form-wrapper"},[e("div",{staticClass:"form"},[e("div",{staticClass:"tab-head",attrs:{slot:"head"},slot:"head"},[e("img",{staticClass:"logo",attrs:{src:"/static/image/pure-logo.png",width:"85px",height:"84px"}}),this._v(" "),e("router-link",{attrs:{to:"/login"}},[this._v("登录")]),this._v(" "),e("router-link",{attrs:{to:"/sign"}},[this._v("注册")])],1),this._v(" "),e("router-view",{staticClass:"form-body"})],1)])])},staticRenderFns:[]};var p=s("VU/8")(d,h,!1,function(t){s("bHyx")},null,null).exports,v=s("Dd8w"),m=s.n(v),f={name:"home",data:function(){return{keyword:""}},computed:m()({},Object(i.b)(["username","userType","avatar","id"]),{getAvatar:function(){return"default_avatar.png"===this.$store.getters.avatar?"/static/image/default_avatar.png":"/show/avatar/"+this.$store.getters.id+"/"+this.$store.getters.avatar}}),methods:m()({},Object(i.c)({userLogout:"logout"}),{refresh:function(){this.$router.push("/user"),this.$router.go(-1)},handleCommand:function(t){switch(t){case"logout":this.userLogout(),this.$router.push("/login");break;case"user":this.$router.push("/user")}},search:function(){this.$router.push("/tasks"),this.$refs.child.getTaskInfos(1)}})},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("header",[s("nav",{staticClass:"head-nav"},[s("div",{staticClass:"fl"},[t._m(0),t._v(" "),s("div",{staticClass:"links"},[0===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/home-view"},nativeOn:{click:function(e){return t.refresh(e)}}},[t._v("首页")]):t._e(),t._v(" "),0===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/tasks"},nativeOn:{click:function(e){return t.refresh(e)}}},[t._v("任务中心")]):t._e(),t._v(" "),1===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/publish"}},[t._v("发布任务")]):t._e(),t._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/myTasks"}},[t._v("我的任务")]),t._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/rank"}},[t._v("排行榜")])],1),t._v(" "),0===this.$store.getters.userType?s("el-input",{ref:"searchInput",staticClass:"search-input",attrs:{placeholder:"搜索想要的任务",size:"small","suffix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e()],1),t._v(" "),s("div",{staticClass:"fr"},[s("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"el-icon-bell"}),t._v(" "),s("div",{staticClass:"user-wrapper"},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatar,width:"30px",height:"30px"}}),t._v(" "),s("el-dropdown",{staticClass:"username",attrs:{size:"medium",placement:"bottom"},on:{command:t.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[t._v("\n              "+t._s(t.username)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item"),t._v(" "),s("el-dropdown-item",{attrs:{command:"user"}},[t._v("个人主页")]),t._v(" "),s("el-dropdown-item",{attrs:{divided:"",command:"logout"}},[t._v("退出登录")])],1)],1)],1)])])]),t._v(" "),s("div",{staticClass:"home-view"},[s("router-view",{ref:"child",attrs:{keyword:t.keyword}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"brand",attrs:{href:"/#/home"}},[e("img",{staticClass:"brand-img",attrs:{src:"/static/image/logo.png",width:"169",height:"44",alt:""}})])}]};var k=s("VU/8")(f,g,!1,function(t){s("T/OL")},null,null).exports,_=s("mvHQ"),b=s.n(_),y=s("c/Tr"),x=s.n(y),w=s("M4fF"),C=s.n(w),T={name:"question-no",data:function(){return{active:0,size:0,questions:[]}},methods:{select:function(t){this.active=t,this.$emit("change-active",t+1)},setSize:function(t){this.size=t,this.refresh()},pass:function(t,e){this.questions[e].state=t},result:function(){var t=0,e=!0;return this.questions.forEach(function(s){1===s.state&&t++,2===s.state&&(e=!1)}),e?t/this.size:null},refresh:function(){this.questions=[];for(var t=0;t<this.size;t++)this.questions.push({state:2})}},mounted:function(){this.refresh()}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-no"},t._l(t.questions,function(e,a){return s("div",{key:a,staticClass:"no-block",class:{active:t.active===a,pass:1===e.state,reject:0===e.state},on:{click:function(e){t.select(a)}}},[t._v(t._s(a+1)+"\n  ")])}))},staticRenderFns:[]};var $=!1,P=!1,S=!1,E=!1,N=!1,R={},D={startPosition:{x:0,y:0},endPosition:{x:0,y:0}},z={},L=0,F={name:"TagBoard",data:function(){return{activeIndex:-1,index:0,imageUrl:"https://i1.mifile.cn/f/i/18/mitv4A/40/build.jpg",tags:[{id:0,startPosition:{x:.3,y:.3},endPosition:{x:.5,ey:.5},tagType:1,penPoints:[],descType:0,mapDesc:{},singleDesc:"opo"}],shade:!1,deleteToolTips:[!1,!1,!1,!1],boardState:"",singleDesc:"",overall:"",showMenu:!1,showEdit:!1,showShade:!1,drawMode:1,taskWorker:{taskType:0,desc:"",labels:[],images:[{filename:"",tags:[]}]}}},components:{QuestionNo:s("VU/8")(T,I,!1,function(t){s("GoAp")},null,null).exports},computed:{overallDesc:function(){for(var t=0;t<this.tags.length;t++){var e=this.tags[t];if(0===Number(e.tagType))return console.log(e.singleDesc),e.singleDesc}return"无"}},mounted:function(){var t=this;this.$refs.tagContent.oncontextmenu=function(){return!1},window.addEventListener("resize",this.resizeImg),setTimeout(function(){t.resizeImg()},50),window.onbeforeunload=function(t){return(t=t||window.event)&&(t.returnValue="Sure?"),"Sure?"},this.$nextTick(function(){var e=localStorage.getItem("taskWorker"),s=localStorage.getItem("boardState");if(s&&(t.boardState=s),e){if(t.taskWorker=JSON.parse(e),"check"===t.boardState){var a=t.taskWorker.images;if(a.length>=10){var i=Math.round(Math.sqrt(a.length));i=i<10?10:i,a=C.a.shuffle(a).slice(0,i)}t.taskWorker.images=a}if(t.$refs.questionNo.setSize(t.taskWorker.images.length),t.taskWorker.images.forEach(function(e,s){null===e.tags&&(e.tags=[]),"edit"===t.boardState&&t.$refs.questionNo.pass(2-(e.tags.length>0),s)}),t.imageUrl="/show/"+t.taskWorker.taskId+"/"+t.taskWorker.images[0].filename,t.tags=t.taskWorker.images[0].tags,"edit"===t.boardState)for(var n=0;n<t.tags.length-t.deleteToolTips.length;n++)t.deleteToolTips.push(!1)}}),"edit"===this.boardState&&this.$alert("使用矩形工具画出一个矩形后, 要及时在注释区填入注释，并点击确认键保存哦！","小贴士",{confirmButtonText:"确定",type:"warning"}).then(function(){})},methods:{check:function(t){this.$refs.questionNo.pass(t,this.index)},finishCheck:function(){var t=this,e=this.$refs.questionNo.result();null!==e?this.$ajax.post("/admin/checkTag/"+this.taskWorker.id,this.$qs.stringify({checkResult:e})).then(function(e){0===e.data.code?(localStorage.setItem("boardState",null),localStorage.setItem("fromRoute","/board"),t.$router.go(-1),t.$message.success("审核成功")):t.$message.error("审核失败")}):this.$message.error("还有未审核的题!")},submit:function(t){var e=this,s="";s="PROCESSING"===t?"确认保存当前任务？（保存后可在我的任务中继续完成任务）":"确认已完成所有的标注任务?(提交后将不能再次编辑）",this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.taskWorker.taskState=t,e.$ajax.post("/user/tasks",e.taskWorker).then(function(t){e.$message({type:"success",message:"成功!"}),e.$router.push("/myTasks")}).catch(function(){e.$message({type:"info",message:"失败，服务器开小差啦"})})}).catch(function(){e.$message({type:"info",message:"已取消提交"})})},giveUp:function(){var t=this;this.$confirm("确认放弃本次标注任务？（标注结果将不会保存）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.push("/home-view")}).catch(function(){})},cancelDelete:function(t){this.deleteToolTips[t]=!1,this.$set(this.deleteToolTips,t,!1)},changeIndex:function(t){t-=1,this.index=t,this.imageUrl="/show/"+this.taskWorker.taskId+"/"+this.taskWorker.images[t].filename,this.tags=this.taskWorker.images[t].tags},confirmOverall:function(){""===this.overall.trim()?this.$message.error("空白标注，请重新输入"):(this.tags.push({tagType:0,id:0,descType:0,singleDesc:this.overall}),this.$message.success("标注成功"),this.refreshQuestionNo(this.index))},adjZIndex:function(){var t=x()(document.getElementsByClassName("tag")),e=[];t.forEach(function(t){var s=t.offsetWidth*t.offsetHeight;e.push(s)}),t.forEach(function(t){var s=t.offsetWidth*t.offsetHeight,a=0;e.forEach(function(t){s<=t&&a++}),t.style.zIndex=a})},selectMode:function(t){this.drawMode=Number(t)},resizeImg:function(){console.log("here1");var t=this.$refs.img.naturalWidth,e=this.$refs.img.naturalHeight,s=this.$refs.tagContent;this.$refs.imgBody.style.height=e*s.offsetWidth/t+"px"},clickTag:function(t,e,s){if(3===t.which)return this.$refs.dropMenu.style.left=t.clientX+"px",this.$refs.dropMenu.style.top=t.clientY+"px",this.showMenu=!0,void(this.activeIndex=e);$=!0,this.showMenu=!1,this.showShade=!0,S=!0,this.activeIndex=e;var a=this.$refs.tagContent;R={x:this._offset(a).left,y:this._offset(a).top,cx:t.clientX,cy:t.clientY,w:a.offsetWidth,h:a.offsetHeight},D.startPosition.x=s.startPosition.x,D.startPosition.y=s.startPosition.y,D.endPosition.x=s.endPosition.x,D.endPosition.y=s.endPosition.y,z=s},move:function(t){1===this.drawMode?this.moveTag(t):this.movePoint(t)},movePoint:function(t){if($&&2===Number(this.drawMode)){N||(this.tags.push({tagType:2,startPosition:{x:0,y:0},endPosition:{x:0,y:0},penPoints:[],descType:0,singleDesc:"",mapDesc:{}}),N=!0,this.activeIndex=this.tags.length-1),this.showShade=!1;var e=this.$refs.tagContent;R={x:this._offset(e).left,y:this._offset(e).top,cx:t.clientX,cy:t.clientY,w:e.offsetWidth,h:e.offsetHeight};var s={x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h,tagType:this.drawMode};this.tags[this.activeIndex].penPoints.push(s)}},moveTag:function(t){if($&&S)z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w,z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h,z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w,z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h,z.startPosition.y<0&&(z.startPosition.y=0),z.startPosition.x<0&&(z.startPosition.x=0),z.endPosition.y<0&&(z.endPosition.y=0),z.startPosition.x<0&&(z.endPosition.x=0),z.endPosition.y>1&&(z.endPosition.y=1),z.endPosition.x>1&&(z.endPosition.x=1),z.startPosition.y>1&&(z.startPosition.y=1),z.startPosition.x>1&&(z.startPosition.x=1);else if(E&&$)1===L?(D.startPosition.x>D.endPosition.x?z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w:z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w,D.startPosition.y>D.endPosition.y?z.endPosition.y=D.endPosition.y+(t.clientX-R.cx)/R.w:z.startPosition.y=D.startPosition.y+(t.clientX-R.cx)/R.w):2===L?D.startPosition.y>D.endPosition.y?z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h:z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h:3===L?(D.startPosition.x>D.endPosition.x?z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w:z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w,D.startPosition.y>D.endPosition.y?z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h:z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h):4===L?D.startPosition.x>D.endPosition.x?z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w:z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w:5===L?D.startPosition.x>D.endPosition.x?z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w:z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w:6===L?(D.startPosition.x>D.endPosition.x?z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w:z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w,D.startPosition.y>D.endPosition.y?z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h:z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h):7===L?D.startPosition.y>D.endPosition.y?z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h:z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h:8===L&&(D.startPosition.x>D.endPosition.x?z.startPosition.x=D.startPosition.x+(t.clientX-R.cx)/R.w:z.endPosition.x=D.endPosition.x+(t.clientX-R.cx)/R.w,D.startPosition.y>D.endPosition.y?z.startPosition.y=D.startPosition.y+(t.clientY-R.cy)/R.h:z.endPosition.y=D.endPosition.y+(t.clientY-R.cy)/R.h);else if($)if(N)this.activeIndex=this.tags.length-1,this.showShade=!0,this.tags[this.tags.length-1].endPosition.x=this.tags[this.tags.length-1].startPosition.x+(t.clientX-R.cx)/R.w,this.tags[this.tags.length-1].endPosition.y=this.tags[this.tags.length-1].startPosition.y+(t.clientY-R.cy)/R.h;else{var e=this.$refs.tagContent;R={x:this._offset(e).left,y:this._offset(e).top,cx:t.clientX,cy:t.clientY,w:e.offsetWidth,h:e.offsetHeight};var s={id:0,startPosition:{x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h},endPosition:{x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h},tagType:this.drawMode};0===this.taskWorker.taskType&&(s.descType=1,s.mapDesc={},this.taskWorker.labels.forEach(function(t){s.mapDesc[t]=""})),this.tags.push(s),this.deleteToolTips.push(!1),z=s,N=!0}},clickSpot:function(t,e,s){$=!0,E=!0,this.showShade=!0;var a=this.$refs.tagContent;R={x:this._offset(a).left,y:this._offset(a).top,cx:t.clientX,cy:t.clientY,w:a.offsetWidth,h:a.offsetHeight},D.startPosition.x=s.startPosition.x,D.startPosition.y=s.startPosition.y,D.endPosition.x=s.endPosition.x,D.endPosition.y=s.endPosition.y,L=e,z=s},finishTag:function(t){$=!1,S=!1,E=!1,N&&(this.showEdit=!0,N=!1,this.activeIndex=this.tags.length-1),this.showShade=!1,this.adjZIndex()},clickContent:function(){$=!0,this.activeIndex=-1,this.showMenu=!1},cancelConfirm:function(){this.showEdit=!1,P?(P=!1,console.log(D.mapDesc),this.tags[this.activeIndex].mapDesc=D.mapDesc):(this.tags.splice(this.activeIndex,1),this.activeIndex=-1)},confirm:function(){if(0===this.taskWorker.taskType);else{if(""===this.singleDesc.trim())return void this.$message.error("空白的标注，请重新输入");this.tags[this.activeIndex].singleDesc=this.singleDesc,this.tags[this.activeIndex].descType=0,this.singleDesc=""}this.tags[this.activeIndex].id=0,this.showEdit=!1,this.refreshQuestionNo(this.index),P=!1},deleteTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeIndex;this.deleteToolTips[t]=!1,this.tags.splice(t,1),this.showMenu=!1,this.refreshQuestionNo(this.index),this.activeIndex=-1},editTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeIndex;P=!0,this.activeIndex=t,this.showEdit=!0,0!==this.taskWorker.taskType?this.singleDesc=this.tags[t].singleDesc:D=JSON.parse(b()(this.tags[t])),this.showMenu=!1},refreshQuestionNo:function(t){this.$refs.questionNo.pass(2-(this.tags.length>0),t)},_offset:function(t){var e=void 0,s=void 0;for(e=0,s=0;t.offsetParent;)e+=t.offsetTop,s+=t.offsetLeft,t=t.offsetParent;return{top:e,left:s}}}},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"tag-board"}},[s("div",{ref:"colLeft",staticClass:"col-left"},["edit"===t.boardState?s("div",{directives:[{name:"show",rawName:"v-show",value:"无"===t.overallDesc,expression:"overallDesc === '无'"}]},[s("h1",{staticClass:"title"},[t._v("整体描述")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"overall-desc"},[s("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入对图片的整体描述"},model:{value:t.overall,callback:function(e){t.overall=e},expression:"overall"}}),t._v(" "),s("el-button",{attrs:{type:"plain",size:"small"},on:{click:t.confirmOverall}},[t._v("确认")])],1)])]):t._e(),t._v(" "),s("div",{staticClass:"results"},[s("h1",{staticClass:"title"},[t._v("标注结果")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"overall-wrapper"},[s("h1",{staticClass:"label"},[t._v("整体描述")]),t._v(" "),s("p",{staticClass:"overall-text"},[t._v(t._s(t.overallDesc))])]),t._v(" "),s("div",{staticClass:"part-wrapper"},[s("h1",{staticClass:"label"},[t._v("局部标注")]),t._v(" "),0===t.tags.length?s("div",[t._v("无")]):t._e(),t._v(" "),s("ul",{staticClass:"tag-list"},t._l(t.tags,function(e,a){return 0!==e.tagType?s("li",{key:a,staticClass:"tag-item"},[0===e.descType?s("div",{staticClass:"single"},[s("span",[t._v(t._s(a+1)+". "+t._s(e.singleDesc))]),t._v(" "),s("div",{staticClass:"icon-group"},[s("i",{staticClass:"el-icon-edit",on:{click:function(e){t.editTag(a)}}}),t._v(" "),s("el-popover",{attrs:{placement:"right",width:"160"},model:{value:t.deleteToolTips[a],callback:function(e){t.$set(t.deleteToolTips,a,e)},expression:"deleteToolTips[index]"}},[s("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("确定删除这个标注吗？")]),t._v(" "),s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.cancelDelete(a)}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.deleteTag(a)}}},[t._v("确定")])],1),t._v(" "),s("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)]):t._e(),t._v(" "),1===e.descType?s("div",{staticClass:"map"},[s("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(a+1))]),t._v(" "),t._l(Object.keys(e.mapDesc),function(a,i){return s("div",{key:i,staticStyle:{"margin-bottom":"3px"}},[t._v(t._s(a)+": "+t._s(e.mapDesc[a])+"\n                ")])}),t._v(" "),s("div",{staticClass:"icon-group"},[s("i",{staticClass:"el-icon-edit",on:{click:function(e){t.editTag(a)}}}),t._v(" "),s("el-popover",{attrs:{placement:"right",width:"160"},model:{value:t.deleteToolTips[a],callback:function(e){t.$set(t.deleteToolTips,a,e)},expression:"deleteToolTips[index]"}},[s("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("确定删除这个标注吗？")]),t._v(" "),s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.cancelDelete(a)}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.deleteTag(a)}}},[t._v("确定")])],1),t._v(" "),s("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)],2):t._e()]):t._e()}))])])])]),t._v(" "),s("div",{staticClass:"col-mid"},[s("div",{staticClass:"img-box"},[s("div",{staticClass:"img-body-wrapper"},[s("span",{ref:"imgBody",staticClass:"img-body"},[s("img",{ref:"img",staticClass:"img",attrs:{src:t.imageUrl,width:"100%",height:"100%"}}),t._v(" "),s("div",{ref:"tagContent",staticClass:"tag-content",on:{mouseup:function(e){t.finishTag(e)},mousemove:function(e){t.move(e)},mousedown:t.clickContent}},[s("div",{staticClass:"tag-wrapper"},t._l(t.tags,function(e,a){return 1===Number(e.tagType)?s("div",{key:a,staticClass:"tag",class:{active:a===t.activeIndex},style:{left:100*(e.endPosition.x-e.startPosition.x>0?e.startPosition.x:e.endPosition.x)+"%",top:100*(e.endPosition.y-e.startPosition.y>0?e.startPosition.y:e.endPosition.y)+"%",width:100*Math.abs(e.endPosition.x-e.startPosition.x)+"%",height:100*Math.abs(e.endPosition.y-e.startPosition.y)+"%",background:t.showShade?"rgba(0, 0, 0, 0)":"rgba(255, 0, 0, 0.3)"},on:{mousedown:function(s){s.stopPropagation(),t.clickTag(s,a,e)}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!(t.showShade&&t.activeIndex===a),expression:"!(showShade && activeIndex === index)"}],staticClass:"tag-text"},[t._v(t._s(e.singleDesc))]),t._v(" "),s("div",{staticClass:"spot-wrapper"},t._l(8,function(a){return s("i",{key:a,staticClass:"spot",attrs:{id:"spot"},on:{mousedown:function(s){s.stopPropagation(),t.clickSpot(s,a,e)}}})})),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showShade&&t.activeIndex===a,expression:"showShade && activeIndex === index"}],staticClass:"em-wrapper"},t._l(4,function(t){return s("div",{key:t,staticClass:"em"})}))]):t._e()})),t._v(" "),2===t.taskWorker.taskType?s("div",{staticClass:"point-tag-wrapper"},t._l(t.tags,function(e,a){return 2===Number(e.tagType)?s("div",{key:a,staticClass:"point-tag"},t._l(e.penPoints,function(t,e){return s("div",{key:e,staticClass:"point",style:{left:100*t.x+"%",top:100*t.y+"%"}})})):t._e()})):t._e()])])]),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showMenu,expression:"showMenu"}],ref:"dropMenu",staticClass:"drop-menu"},[s("div",[s("div",{staticClass:"btn delete-btn",on:{click:t.deleteTag}},[t._v("删除")]),t._v(" "),s("div",{staticClass:"btn edit-btn",on:{click:t.editTag}},[t._v("编辑")])])])]),t._v(" "),s("transition",{staticClass:"animated",attrs:{"enter-active-class":"bounceIn","leave-active-class":"bounceOut"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showEdit,expression:"showEdit"}],staticClass:"input-box-wrapper"},[s("div",{staticClass:"input-box"},[s("div",{staticClass:"header"},[s("span",{staticClass:"title"},[t._v("编辑内容")]),t._v(" "),s("i",{staticClass:"el-icon-close close-btn",on:{click:t.cancelConfirm}})]),t._v(" "),s("div",{staticClass:"content"},[0!==t.taskWorker.taskType?s("div",[s("el-input",{attrs:{size:"small"},model:{value:t.singleDesc,callback:function(e){t.singleDesc=e},expression:"singleDesc"}})],1):t._e(),t._v(" "),0===t.taskWorker.taskType&&t.activeIndex>=0?s("div",t._l(t.taskWorker.labels,function(e,a){return s("div",{key:a},[s("span",[t._v(t._s(e))]),t._v(" "),s("el-input",{staticStyle:{margin:"10px 0"},attrs:{size:"small"},model:{value:t.tags[t.activeIndex].mapDesc[e],callback:function(s){t.$set(t.tags[t.activeIndex].mapDesc,e,s)},expression:"tags[activeIndex].mapDesc[label]"}})],1)})):t._e(),t._v(" "),s("div",{staticClass:"my-btn-group"},[s("el-button",{staticClass:"btn confirm-btn",attrs:{size:"small",type:"primary"},on:{click:t.confirm}},[t._v("确定")]),t._v(" "),s("el-button",{staticClass:"btn cancel-btn",attrs:{size:"small"},on:{click:t.cancelConfirm}},[t._v("取消")])],1)])])])])],1),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"tagutil-wrapper"},[s("div",{staticClass:"task-info"},[s("h1",{staticClass:"title"},[t._v("任务信息")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"label"},[t._v("任务描述")]),t._v(" "),s("div",{staticClass:"desc"},[t._v(t._s(t.taskWorker.description))]),t._v(" "),s("question-no",{ref:"questionNo",staticClass:"question-no",on:{"change-active":t.changeIndex}}),t._v(" "),"edit"===t.boardState?s("div",{staticClass:"edit-btn-group"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.submit("SUBMITTED")}}},[t._v("提交")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.submit("PROCESSING")}}},[t._v("保存")]),t._v(" "),s("el-button",{attrs:{type:"plain",size:"mini"},on:{click:t.giveUp}},[t._v("放弃")])],1):t._e(),t._v(" "),"check"===t.boardState?s("div",{staticClass:"read-btn-group"},[s("el-button",{attrs:{type:"plain",size:"small"},on:{click:function(e){t.check(1)}}},[t._v("通过")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){t.check(0)}}},[t._v("拒绝")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.finishCheck}},[t._v("完成")])],1):t._e()],1)]),t._v(" "),"edit"===t.boardState?s("div",{staticClass:"utils"},[s("h1",{staticClass:"title"},[t._v("工具区")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"btn-group"},[s("el-radio-group",{ref:"utils",attrs:{size:"small"},model:{value:t.drawMode,callback:function(e){t.drawMode=e},expression:"drawMode"}},[s("el-radio-button",{attrs:{label:1,disabled:2==t.taskWorker.taskType},on:{click:function(e){t.selectMode(1)}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("矩形\n              ")]),t._v(" "),s("el-radio-button",{attrs:{label:2,disabled:2!==t.taskWorker.taskType},on:{click:function(e){t.selectMode(2)}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("铅笔\n              ")])],1)],1),t._v(" "),s("el-row")],1)]):t._e()])])])},staticRenderFns:[]};var O=s("VU/8")(F,U,!1,function(t){s("OUxK")},null,null).exports,V=s("9WQZ"),A=s.n(V),M=(s("fjIZ"),{name:"publish",data:function(){return{uploadData:{id:0},endDateOpt:this.disabledDate(),filelist:[],task:{userId:this.$store.getters.id,title:"",description:"",taskType:0,endDate:"",price:0,numPerPic:0,labels:[],topics:[],startDate:(new Date).Format("yyyy-MM-dd hh:mm"),images:[]},inputVisible:!1,inputValue:""}},watch:{"task.numPerPic":function(){this.refreshPrice()},"task.images":function(){this.refreshPrice()}},methods:{refreshPrice:function(){this.task.price=this.task.images.length*this.task.numPerPic},disabledDate:function(){return{disabledDate:function(t){return t.getTime()<Date.now()}}},addLabel:function(){this.task.labels.push("")},deleteLabel:function(t){this.task.labels.splice(t,1)},addImage:function(t,e){this.checkSize(t)||this.removeImage(t);for(var s=this.$refs.uploadFile.uploadFiles,a=0,i=0;i<s.length;i++)if(s[i].name===t.name){if(1===a)return this.$message.error("请不要上传同名图片！"),this.$refs.uploadFile.abort(t),void s.splice(s.indexOf(t),1);a++}this.task.images.push(t.name)},removeImage:function(t){for(var e=this.$refs.uploadFile.uploadFiles,s=0;s<e.length;s++)if(e[s].name===t.name)return e.splice(s,1),void this.task.images.splice(s,1)},checkSize:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传图片大小不能超过 2 MB!"),e},validate:function(){var t=this.task;return!(""===t.title||""===t.description||0===t.taskType&&0===t.labels.length||""===t.endDate||t.price<=0||0===t.images.length)},publish:function(){var t=this;this.validate()?this.$ajax.post("/tasks/new",this.task).then(function(e){0===e.data.code?(t.$message.success("发布成功，已提交审核"),t.uploadData.id=e.data.data.id,t.$refs.uploadFile.submit(),t.$router.push("/home")):t.$message.error("发布失败")}).catch(function(){t.$message.error("发布失败")}):this.$message.error("信息填写不完整")},cancel:function(){var t=this;this.$confirm("确定放弃本次发布任务吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.push("/home")}).catch(function(){})},showInput:function(){this.inputVisible=!0},handleInputConfirm:function(){this.inputVisible=!1,this.inputValue=A()(this.inputValue),""!==this.inputValue&&this.task.topics.push(this.inputValue),this.inputValue=""},querySearch:function(t,e){var s=[{value:"动物"},{value:"植物"},{value:"车辆"},{value:"医学"},{value:"IT"},{value:"人类"}];e(t?s.filter(this.createFilter(t)):s)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleClose:function(t){this.task.topics.splice(this.task.topics.indexOf(t),1)}}}),j={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"publish"},[s("div",{staticClass:"article"},[s("div",{staticClass:"title"},[t._v("发布标注任务")]),t._v(" "),s("el-form",{ref:"taskForm",attrs:{"label-width":"110px","label-position":"left",size:"medium"},model:{value:t.task,callback:function(e){t.task=e},expression:"task"}},[s("el-form-item",{attrs:{label:"任务名称",prop:"title"}},[s("el-input",{attrs:{placeholder:"任务名称"},model:{value:t.task.title,callback:function(e){t.$set(t.task,"title",e)},expression:"task.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"任务描述"}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"任务描述"},model:{value:t.task.description,callback:function(e){t.$set(t.task,"description",e)},expression:"task.description"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"图片主题"}},[t._l(t.task.topics,function(e,a){return t.task.topics.length>0?s("el-tag",{key:a,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){t.handleClose(e)}}},[t._v("\n          "+t._s(e)+"\n        ")]):t._e()}),t._v(" "),t.inputVisible?s("el-autocomplete",{staticClass:"input-new-tag",attrs:{size:"small","fetch-suggestions":t.querySearch},on:{select:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):s("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])],2),t._v(" "),s("el-form-item",{attrs:{label:"截止时间"}},[s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd hh:mm","value-format":"yyyy-MM-dd hh:mm",placeholder:"选择截止时间","picker-options":t.endDateOpt},model:{value:t.task.endDate,callback:function(e){t.$set(t.task,"endDate",e)},expression:"task.endDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"标注类型",prop:"taskType"}},[s("el-radio-group",{model:{value:t.task.taskType,callback:function(e){t.$set(t.task,"taskType",e)},expression:"task.taskType"}},[s("el-radio",{attrs:{label:0}},[t._v("分类标注")]),t._v(" "),s("el-radio",{attrs:{label:1}},[t._v("标框标注")]),t._v(" "),s("el-radio",{attrs:{label:2}},[t._v("区域标注")])],1)],1),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===t.task.taskType,expression:"task.taskType === 0"}],attrs:{label:"分类标注标签",prop:"labels"}},[s("el-form",{staticClass:"label-form",attrs:{size:"small"},model:{value:t.task.labels,callback:function(e){t.$set(t.task,"labels",e)},expression:"task.labels"}},[t._l(t.task.labels,function(e,a){return s("el-form-item",{key:a,attrs:{label:"标签"+(a+1)}},[s("el-input",{model:{value:t.task.labels[a],callback:function(e){t.$set(t.task.labels,a,e)},expression:"task.labels[index]"}}),t._v(" "),s("el-button",{staticClass:"delete-btn",attrs:{type:"danger"},on:{click:function(e){t.deleteLabel(a)}}},[t._v("删除")])],1)}),t._v(" "),s("el-button",{attrs:{plain:""},on:{click:t.addLabel}},[t._v("添加标签")])],2)],1),t._v(" "),s("el-form-item",{attrs:{label:"上传图片",prop:"images"}},[s("el-upload",{ref:"uploadFile",attrs:{drag:"",action:"/upload/task",data:t.uploadData,"auto-upload":!1,multiple:"","on-change":t.addImage,"before-remove":t.removeImage,accept:"image/jpg","file-list":t.filelist}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg文件，且不超过2Mb")])])],1),t._v(" "),s("el-form-item",{staticClass:"num-per-pic",attrs:{label:"标注人数/图"}},[s("el-input-number",{attrs:{min:1},model:{value:t.task.numPerPic,callback:function(e){t.$set(t.task,"numPerPic",e)},expression:"task.numPerPic"}})],1),t._v(" "),s("el-form-item",{staticClass:"price",attrs:{label:"任务总价"}},[s("el-input-number",{attrs:{min:Math.round(t.task.images.length*t.task.numPerPic)},model:{value:t.task.price,callback:function(e){t.$set(t.task,"price",e)},expression:"task.price"}}),t._v(" "),s("span",[t._v("一张图最少1T币哦！")])],1)],1),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:t.publish}},[t._v("发布")]),t._v(" "),s("el-button",{staticClass:"cancel-btn",attrs:{type:"plain"},on:{click:t.cancel}},[t._v("取消")])],1)],1)])},staticRenderFns:[]};var W=s("VU/8")(M,j,!1,function(t){s("QM0R")},null,null).exports,B={name:"topic",props:{text:{type:String}}},q={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"topic"},[e("div",[this._v(this._s(this.text))])])},staticRenderFns:[]};var X=s("VU/8")(B,q,!1,function(t){s("nc7f")},null,null).exports,Y={name:"star",props:{size:{type:Number,default:48},score:{type:Number,default:5}},computed:{itemClasses:function(){for(var t=[],e=Math.floor(2*this.score)/2,s=0;s<e;s++)t.push("on");for(e%1!=0&&t.push("half");t.length<5;)t.push("off");return t}}},H={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"star",class:"star-"+this.size},this._l(this.itemClasses,function(t){return e("span",{key:t.id,staticClass:"star-item",class:t})}))},staticRenderFns:[]};var G=s("VU/8")(Y,H,!1,function(t){s("Tmu6")},null,null).exports,J={components:{Topic:X,Star:G},props:{keyword:{type:String}},name:"tasks",watch:{sortBy:function(){this.isSec=!0,this.getTaskInfos(1)},isSec:function(){this.getTaskInfos(1)}},data:function(){return{secCount:0,page:1,sortBy:"全部",isSec:!0,totalItemNum:0,taskInfos:[]}},mounted:function(){this.getTaskInfos(1)},methods:{enterTask:function(t){var e=this.taskInfos[t];localStorage.setItem("taskInfo",b()(e)),localStorage.setItem("taskState","new"),this.$router.push("/task-detail")},taskType:function(t){return["分类","标框","区域"][t]},changeSec:function(){this.secCount%2==0&&(this.isSec=!this.isSec),this.secCount++},changePage:function(t){this.page=t,this.getTaskInfos(t)},getTaskInfos:function(t){var e=this,s=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",target:document.body});this.$ajax.get("/user/tasks/search",{params:{userId:Number(this.$store.getters.id),keyword:this.keyword,sortBy:this.sortBy,isSec:this.isSec,size:9,page:t}}).then(function(s){e.page=t;var a=(s=s.data).data;e.taskInfos=a.data,e.totalItemNum=a.totalItemNum,e.scrollTop()}).catch(function(){e.$message.error("查询失败")}).finally(function(){setTimeout(function(){s.close()},500)})},scrollTop:function(){var t=setInterval(function(){var e=document.documentElement.scrollTop||document.body.scrollTop;(e-=10)>0?window.scrollTo(0,e):(window.scrollTo(0,0),clearInterval(t),t=null)},1)}}},Q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tasks"},[s("div",{attrs:{id:"head"}}),t._v(" "),s("div",{staticClass:"task-wrapper"},[s("div",{staticClass:"task-head",staticStyle:{height:"70px"}},[s("h1",{staticClass:"title",staticStyle:{float:"left"}},[t._v("任务列表")]),t._v(" "),s("div",{staticClass:"seq-filter",staticStyle:{float:"right"}},[s("el-radio-group",{attrs:{size:"medium"},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},[s("el-radio-button",{attrs:{label:"全部"}},[t._v("全部")]),t._v(" "),s("el-radio-button",{attrs:{label:"时间"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("时间 "),"时间"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"好评率"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("好评率 "),"好评率"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"奖励"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("奖励 "),"奖励"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"任务量"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("任务量 "),"任务量"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()])],1)],1),t._v(" "),s("div",{staticClass:"filters"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"cla-filter"},[s("label",[t._v("选择类别:")]),t._v(" "),s("span",{staticClass:"cla-item"},[t._v("动物")]),t._v(" "),s("span",{staticClass:"cla-item"},[t._v("植物")]),t._v(" "),s("span",{staticClass:"cla-item"},[t._v("车辆")])])])]),t._v(" "),s("div",{staticClass:"tasks",attrs:{id:"tasks"}},[t._l(t.taskInfos,function(e,a){return s("div",{key:a,staticClass:"task-card",on:{click:function(e){t.enterTask(a)}}},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("div",{staticClass:"image-wrapper"},[s("img",{staticClass:"image",attrs:{src:"/show/"+e.id+"/"+e.picName}})]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"task-title"},[t._v(t._s(e.title))]),t._v(" "),s("star",{staticClass:"hotrank",attrs:{score:e.rating,size:24}}),t._v(" "),s("div",{staticClass:"price"},[t._v(t._s(e.price)+" T币")]),t._v(" "),s("div",{staticClass:"topics"},t._l(e.topics,function(t,e){return s("topic",{key:e,staticClass:"item",attrs:{text:t}})})),t._v(" "),s("div",{staticClass:"info-blocks"},[s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务量")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(e.picNum))]),s("span",{staticClass:"unit"},[t._v("题")])])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("类型")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(t.taskType(e.taskType)))])])])]),t._v(" "),s("div",{staticClass:"startDate"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(e.startDate)+" 发布")])],1)])],1)}),t._v(" "),t._l(3,function(t){return s("div",{key:t-3,staticClass:"task-card"},[s("div",{staticClass:"empty"})])})],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.totalItemNum,expression:"totalItemNum === 0"}]},[s("i",{staticClass:"el-icon-warning"}),t._v("\n      当前暂无可接受的任务\n    ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"page"},[s("el-pagination",{ref:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":9,"current-page":t.page,total:this.totalItemNum,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":t.changePage}})],1)])])},staticRenderFns:[]};var Z=s("VU/8")(J,Q,!1,function(t){s("Usuq")},null,null).exports,K=s("fZjL"),tt=s.n(K),et=s("Icdr");s("Vb+l"),s("Oq2I"),s("80cc"),s("miEh");var st={name:"user",data:function(){return{rechargeDialogVisible:!1,rechargeAmount:0,showUpload:!1,user:{},showChangeAvatarBtn:!1}},computed:{uploadData:function(){return{id:this.user?this.user.id:0}},getLevel:function(){switch(this.user.level){case"LEVEL_ONE":return 1;case"LEVEL_TWO":return 2;case"LEVEL_THREE":return 3;case"LEVEL_FOUR":return 4;case"LEVEL_FIVE":return 5;case"LEVEL_SIX":return 6;case"LEVEL_SEVEN":return 7}},getTitle:function(){switch(this.user.level){case"LEVEL_ONE":return"塑料";case"LEVEL_TWO":return"玄铁";case"LEVEL_THREE":return"青铜";case"LEVEL_FOUR":return"白银";case"LEVEL_FIVE":return"黄金";case"LEVEL_SIX":return"铂金";case"LEVEL_SEVEN":return"钻石"}},getAvatar:function(){return this.user&&this.user.id&&"default_avatar.png"!==this.user.avatar?"/show/avatar/"+this.user.id+"/"+this.user.avatar:"/static/image/default_avatar.png"}},mounted:function(){var t=this,e=this.$store.getters.id;this.$ajax.get("/user/info/"+e).then(function(e){var s=e.data;0===s.code?t.user=s.data:t.$message.error("查看个人信息失败！")}),0===this.$store.getters.userType&&this.drawTaskTypeChart()},methods:m()({},Object(i.c)({setAvatar:"changeAvatar"}),{attend:function(){var t=this;this.$ajax.get("/user/"+this.user.id+"/attend").then(function(e){0===e.data.code?(t.user.points+=1,t.user.exp+=1,t.user.isAttendant=!0):t.$message.error("签到失败")}).catch(function(){t.$message.error("签到失败")})},recharge:function(){var t=this;this.$ajax.post("/user/"+this.user.id+"/recharge",this.$qs.stringify({amount:this.rechargeAmount})).then(function(e){0===e.data.code?(t.user.points+=Math.round(10*Number(t.rechargeAmount)),t.$message.success("充值成功")):t.$message.error("充值失败")}).catch(function(){t.$message.error("充值失败")}).finally(function(){t.rechargeDialogVisible=!1})},drawTaskTypeChart:function(){var t=et.init(this.$refs.taskTypeChart);t.setOption({title:{text:"任务话题统计",textStyle:{fontSize:20,fontWeight:700},x:"center"},legend:{show:!0,orient:"horizontal",top:40,data:["动物","人类","医学"]},tooltip:{},series:{type:"pie",radius:"60%",center:["50%","60%"],data:[{name:"动物",value:4},{name:"人类",value:5},{name:"医学",value:10}]}}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskWorker/taskType",{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=tt()(a),n=[];i.forEach(function(t){n.push({name:t,value:a[t]})}),t.setOption({legend:{data:i},series:{data:n}})}})},toggleChangeAvatarBtn:function(){this.showChangeAvatarBtn=!this.showChangeAvatarBtn},toggleUpload:function(){this.showUpload=!this.showUpload},uploadSuccess:function(t,e,s){this.toggleUpload(),this.user.avatar=e.name,this.setAvatar(e.name)}})},at={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-view"},[s("div",{staticClass:"user-info-wrapper"},[s("div",{staticClass:"col-left"},[s("div",{staticClass:"user-wrapper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showUpload,expression:"!showUpload"}],staticClass:"avatar-box",staticStyle:{width:"150px",height:"150px"},on:{mouseover:t.toggleChangeAvatarBtn,mouseout:t.toggleChangeAvatarBtn}},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatar,width:"150px",height:"150px"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showChangeAvatarBtn,expression:"showChangeAvatarBtn"}],staticClass:"change-avatar-btn",on:{click:t.toggleUpload}},[t._v("更换头像")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],staticClass:"change-avatar-box"},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/upload/avatar",data:t.uploadData,accept:"image/*","show-file-list":!1,"on-success":t.uploadSuccess}},[s("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("图片大小不超过2Mb")])])],1),t._v(" "),s("div",{staticClass:"userinfo-box"},[s("div",{staticClass:"username"},[t._v(t._s(t.user.username)),s("span",{staticClass:"level"},[t._v("Lv."+t._s(t.getLevel))])]),t._v(" "),s("div",{staticClass:"exp info-line"},[t._v("经验值: "+t._s(t.user.exp))]),t._v(" "),s("div",{staticClass:"title info-line"},[t._v("称号: "+t._s(t.getTitle))]),t._v(" "),s("div",{staticClass:"phone info-line"},[t._v("手机: "+t._s(t.user.phone))]),t._v(" "),s("div",{staticClass:"email info-line"},[t._v("邮箱: "+t._s(t.user.email))])])])]),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"reward-wrapper"},[s("label",[t._v("我的积分")]),t._v(" "),s("div",{staticClass:"reward-num"},[t._v("\n          "+t._s(t.user.points)+"\n        ")]),t._v(" "),t.user.isAttendant||0!==t.user.userType?t._e():s("div",{staticClass:"attend"},[s("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:t.attend}},[t._v("签到\n          ")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.user.isAttendant,expression:"user.isAttendant"}],staticClass:"attend-tip"},[t._v("今天已经签到过啦")])],1),t._v(" "),1===t.user.userType?s("div",{staticClass:"recharge"},[s("el-button",{directives:[{name:"",rawName:"v-",value:1===t.user.userType,expression:"user.userType === 1"}],attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.rechargeDialogVisible=!0}}},[t._v("充值\n          ")]),t._v(" "),s("el-dialog",{attrs:{title:"充值积分",visible:t.rechargeDialogVisible,width:"35%",top:"25vh"},on:{"update:visible":function(e){t.rechargeDialogVisible=e}}},[s("el-form",[s("el-form-item",{attrs:{label:"充值额度"}},[s("div",[s("el-input",{attrs:{placeholder:"请输入充值的额度(1RMB = 10积分)"},model:{value:t.rechargeAmount,callback:function(e){t.rechargeAmount=e},expression:"rechargeAmount"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1)])],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.rechargeDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.recharge}},[t._v("确 定")])],1)],1)],1):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.user.userType,expression:"user.userType === 0"}],staticClass:"counts-wrapper"},[s("label",[t._v("我的评价")]),t._v(" "),s("div",{staticClass:"task-counts"},[s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.punctualityRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("准时率")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.accuracyRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("正确率")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.satisfactionRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("满意度")])])])])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===this.$store.getters.userType,expression:"this.$store.getters.userType === 0"}],staticClass:"user-statistics-wrapper"},[s("div",{ref:"taskTypeChart",staticStyle:{width:"50%",height:"330px"}})])])},staticRenderFns:[]};var it=s("VU/8")(st,at,!1,function(t){s("OJiU")},null,null).exports,nt={name:"task-card",components:{Topic:X,Star:G},props:{state:{type:String},taskInfo:{type:Object}},data:function(){return{taskPublisherId:0}},computed:{getBanner:function(){return 0===this.taskPublisherId?"/static/image/default_banner.jpg":"/show/"+this.taskPublisherId+"/"+this.taskInfo.picName}},mounted:function(){var t=this;1===this.$store.getters.userType||"new"===this.state?this.taskPublisherId=this.taskInfo.id:this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;t.taskPublisherId=s.data.taskId})},methods:{enterTask:function(){localStorage.setItem("taskInfo",b()(this.taskInfo)),localStorage.setItem("taskState",this.state),"/task-detail"===this.$route.path?(this.$router.push("/white"),this.$router.go(-1)):this.$router.push("/task-detail")},taskType:function(t){return["分类","标框","区域"][t]}}},rt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-card",on:{click:t.enterTask}},[-1!==t.taskPublisherId?s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("div",{staticClass:"image-wrapper"},[s("img",{staticClass:"image",attrs:{src:t.getBanner}})]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"task-title"},[t._v(t._s(t.taskInfo.title))]),t._v(" "),s("star",{staticClass:"hotrank",attrs:{score:t.taskInfo.rating,size:24}}),t._v(" "),s("div",{staticClass:"price"},[t._v(t._s(t.taskInfo.price)+" T币")]),t._v(" "),s("div",{staticClass:"topics"},t._l(t.taskInfo.topics,function(t,e){return s("topic",{key:e,staticClass:"item",attrs:{text:t}})})),t._v(" "),s("div",{staticClass:"info-blocks"},[s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务量")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(t.taskInfo.picNum))]),s("span",{staticClass:"unit"},[t._v("题")])])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("类型")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(t.taskType(t.taskInfo.taskType)))])])])]),t._v(" "),s("div",{staticClass:"startDate"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(t.taskInfo.startDate)+" 发布")])],1)]):t._e()],1)},staticRenderFns:[]};var ot=s("VU/8")(nt,rt,!1,function(t){s("kmD7")},null,null).exports,lt={name:"pagination",props:{pageSize:{type:Number},page:{type:Number},totalItemNum:{type:Number}},methods:{changePage:function(t){this.$emit("changePage",t)}}},ct={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pagination"},[e("el-pagination",{ref:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":this.pageSize,"current-page":this.page,total:this.totalItemNum,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":this.changePage}})],1)},staticRenderFns:[]};var ut=s("VU/8")(lt,ct,!1,function(t){s("IrNe")},null,null).exports,dt={components:{Pagination:ut,TaskCard:ot},name:"my-task",data:function(){return{page:1,totalItemNum:0,state:"PROCESSING",taskInfos:[]}},watch:{state:function(){var t=this;this.taskInfos=[],this.$nextTick(function(){t.getTaskInfos()})}},mounted:function(){this.getTaskInfos()},methods:{changePage:function(t){this.page=t,this.getTaskInfos()},getTaskInfos:function(){var t=this,e=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",target:document.body});1===this.$store.getters.userType?this.$ajax.get("/tasks/list",{params:{userId:this.$store.getters.id,state:this.state,size:9,page:this.page}}).then(function(e){var s=e.data.data;t.taskInfos=s.data,t.totalItemNum=s.totalItemNum}).finally(function(){setTimeout(function(){e.close()},500)}):this.$ajax.get("/user/"+this.$store.getters.id+"/tasks",{params:{state:this.state,size:9,page:this.page}}).then(function(e){var s=e.data.data;t.taskInfos=s.data,t.totalItemNum=s.totalItemNum}).finally(function(){setTimeout(function(){e.close()},500)})}}},ht={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-task"},[s("el-tabs",{staticClass:"state-tab",model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[s("el-tab-pane",{attrs:{name:"PROCESSING"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-time"}),t._v(" 进行中的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"PROCESSING"===t.state,expression:"state === 'PROCESSING'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),s("el-tab-pane",{attrs:{name:"SUBMITTED"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 已提交的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"SUBMITTED"===t.state,expression:"state === 'SUBMITTED'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),0===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"PASS"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-check"}),t._v(" 通过的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"PASS"===t.state,expression:"state === 'PASS'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),1===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"DONE"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-check"}),t._v(" 已完成的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"DONE"===t.state,expression:"state === 'DONE'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),s("el-tab-pane",{attrs:{name:"REJECT"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-close"}),t._v(" 失败的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"REJECT"===t.state,expression:"state === 'REJECT'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),0===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"OVERTIME"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-close"}),t._v(" 超时的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"OVERTIME"===t.state,expression:"state === 'OVERTIME'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),s("div",{staticClass:"task-out-wrapper"},[s("div",{staticClass:"task-wrapper"},[s("div",{staticClass:"tasks"},[t._l(t.taskInfos,function(e,a){return s("div",{key:a,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":e,state:t.state}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e-20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])})],2)])])],1),t._v(" "),0===t.totalItemNum?s("div",[s("i",{staticClass:"el-icon-warning"}),t._v("没有在该状态的任务")]):t._e(),t._v(" "),t.totalItemNum>0?s("pagination",{attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:9},on:{changePage:t.changePage}}):t._e()],1)},staticRenderFns:[]};var pt=s("VU/8")(dt,ht,!1,function(t){s("jtC2")},null,null).exports,vt=s("Icdr");s("GbHy"),s("rjsW"),s("miEh");var mt={name:"task-detail",components:{TaskCard:ot,Star:G},data:function(){return{state:"",rateValue:0,rateOnlyRead:!1,progress:0,fromPath:"/",taskInfo:{id:0,title:"",taskType:0,startDate:"",endDate:"",price:0},similarTasks:[]}},beforeRouteEnter:function(t,e,s){s(function(t){return t.setFrom(e.path)})},methods:{setFrom:function(t){this.fromPath=t},taskType:function(t){return["分类","标框","区域"][t]},acceptTask:function(){var t=this;this.$ajax.get("/user/new/"+this.taskInfo.id,{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data;localStorage.setItem("taskWorker",b()(a)),localStorage.setItem("boardState","edit"),t.$router.push("/board")}else t.$message.error("接受任务失败")}).catch(function(){t.$message.error("接受任务失败")})},continueTask:function(){var t=this;localStorage.setItem("boardState","edit"),this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;localStorage.setItem("taskWorker",b()(a)),localStorage.setItem("boardState","edit"),t.$router.push("/board")}else t.$message.error("接受任务失败")}).catch(function(){t.$message.error("接受任务失败")})},rate:function(){var t=this;this.rateOnlyRead=!0,this.$ajax.post("/user/rating",this.$qs.stringify({taskWorkerId:this.taskInfo.id,rating:this.rateValue})).then(function(e){0===e.data.code?t.$message.success("感谢您的评价！"):t.$message.error("评价失败")}).catch(function(){t.$message.error("评价失败")})},drawRateChart:function(){var t=vt.init(this.$refs.rateChart);t.setOption({title:{text:"任务评价统计",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){var s=e[0].name,a=0;t.getOption().series[0].data.forEach(function(t){a+=t});for(var i=0,n=e.length;i<n;i++)s+="<br/>"+e[i].value+"人("+(e[i].value/a*100).toFixed(2)+"%)";return s}},legend:{data:["5星","4星","3星","2星","1星"].reverse()},grid:{left:"3%",right:"15%",bottom:"3%",containLabel:!0},xAxis:[{name:"人数(人)",type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:["5星","4星","3星","2星","1星"].reverse()}],series:[{data:[200,22,35,10,90].reverse(),type:"bar",itemStyle:{normal:{color:function(t){return["#FF8607","#FF9900","#ffc001","#F7BA2A","#99A9BF"].reverse()[t.dataIndex]},label:{show:!0,position:"right"}}}}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/rating",{params:{taskPublisherId:this.taskInfo.id}}).then(function(e){var s=e.data;if(0===s.code){for(var a=s.data,i=[],n=1;n<=5;n++)i.push(a[n]);t.setOption({series:[{data:i}]})}})},drawWorkerChart:function(){var t=vt.init(this.$refs.workerChart);t.setOption({title:{text:"工人质量分析",x:"center"},tooltip:{formatter:function(t){var e=t.value;return"工人平均质量<br>\n            等级：Lv."+e[0]+"<br>\n            经验："+e[1]+"<br>\n            积分："+e[2]+"<br>\n            准确率："+e[3]+"%<br>\n            准时率："+e[4]+"%"}},radar:[{indicator:[{text:"等级",max:7},{text:"经验",max:8e3},{text:"积分",max:8e3},{text:"准确率",max:100},{text:"准时率",max:100}],radius:100,center:["50%","60%"]}],series:[{type:"radar",tooltip:{trigger:"item"},itemStyle:{normal:{areaStyle:{type:"default"}}},data:[{value:[4,800,23,78,100]}]}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/workerInfo",{params:{taskPublisherId:this.taskInfo.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.setOption({radar:{indicator:[{text:"等级",max:7},{text:"经验",max:a.exp<500?500:1.2*a.exp},{text:"积分",max:a.point<500?500:1.2*a.point},{text:"准确率",max:100},{text:"准时率",max:100}]},series:[{data:[{value:[a.level,a.exp,a.point,a.accuracyRate,a.punctualityRate]}]}]})}})},drawProgress:function(){var t=this,e="",s={};1===this.$store.getters.userType?(e="/statistics/taskPublisher/progress",s={taskPublisherId:this.taskInfo.id}):0===this.$store.getters.userType&&(e="/statistics/taskWorker/progress",s={taskWorkerId:this.taskInfo.id}),this.$ajax.get(e,{params:s}).then(function(e){var s=e.data;0===s.code&&(t.progress=(100*s.data).toFixed(0))})}},mounted:function(){var t=this,e=localStorage.getItem("taskInfo"),s=localStorage.getItem("taskState");e&&(this.taskInfo=JSON.parse(e),this.state=s),1===this.$store.getters.userType?(this.drawProgress(),this.drawRateChart(),this.drawWorkerChart()):0===this.$store.getters.userType&&("PROCESSING"===this.state&&this.drawProgress(),"PASS"===this.state&&this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.rateValue=a.rating,0!==t.rateValue&&(t.rateOnlyRead=!0)}}),this.$ajax.get("/recommend/item",{params:{taskPublisherId:this.taskInfo.id,userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code&&(t.similarTasks=s.data)}).catch(function(){t.$message.error("获取相似任务失败")}))}},ft={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-detail"},[s("el-row",{staticClass:"task-detail-row",attrs:{gutter:30}},[s("div",{staticClass:"breadcrumb-nav"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},["/tasks"===t.fromPath?s("el-breadcrumb-item",{attrs:{to:{path:"/tasks"}}},[t._v("任务中心")]):t._e(),t._v(" "),"/myTasks"===t.fromPath?s("el-breadcrumb-item",{attrs:{to:{path:"/myTasks"}}},[t._v("我的任务")]):t._e(),t._v(" "),s("el-breadcrumb-item",[t._v("任务详情")])],1)],1),t._v(" "),s("el-col",{attrs:{span:15}},[s("el-card",[s("div",{staticClass:"task-label-wrapper"},[s("div",[s("h1",{staticClass:"title"},[t._v(t._s(t.taskInfo.title))]),t._v(" "),s("div",{staticClass:"topic-wrapper"},t._l(t.taskInfo.topics,function(e,a){return s("el-tag",{key:a,staticClass:"topics"},[t._v(t._s(e))])}))]),t._v(" "),s("div",{staticClass:"col-left"},[s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-document"}),t._v("任务类型: ")]),t._v(" "),s("span",{staticClass:"task-type"},[t._v(t._s(t.taskType(t.taskInfo.taskType))+"标注")])]),t._v(" "),s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-time"}),t._v("发布时间: ")]),t._v(" "),s("span",{staticClass:"start-date"},[t._v(t._s(t.taskInfo.startDate))])])]),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-star-off"}),t._v("任务评价: ")]),t._v(" "),s("star",{staticClass:"hotrank",attrs:{score:t.taskInfo.rating,size:24}})],1),t._v(" "),s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-date"}),t._v("结束时间: ")]),t._v(" "),s("span",[t._v(t._s(t.taskInfo.endDate))])])])]),t._v(" "),s("div",{staticClass:"task-desc-wrapper"},[s("span",{staticClass:"header"},[t._v("任务描述")]),t._v(" "),s("p",{staticClass:"task-desc"},[t._v(t._s(t.taskInfo.description))])])])],1),t._v(" "),s("el-col",{attrs:{span:9}},[s("el-card",{staticClass:"reward-box"},[s("div",[s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务奖励")]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.taskInfo.price)+" T币")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务题量")]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.taskInfo.picNum)+" 图")])]),t._v(" "),0===this.$store.getters.userType?s("div",{staticClass:"worker-button"},["PROCESSING"===t.state?s("el-button",{attrs:{round:"",type:"danger"},on:{click:t.continueTask}},[t._v("继续任务")]):t._e(),t._v(" "),"new"===t.state?s("el-button",{attrs:{round:"",type:"danger"},on:{click:t.acceptTask}},[t._v("开始任务")]):t._e()],1):t._e()])]),t._v(" "),"PROCESSING"===this.state?s("el-card",{staticClass:"progress-card"},[s("h1",{staticClass:"header"},[t._v("任务进度")]),t._v(" "),s("el-progress",{attrs:{percentage:t.progress}})],1):t._e(),t._v(" "),0===this.$store.getters.userType&&"PASS"===t.state?s("el-card",{staticClass:"rate-card"},[s("h1",{staticClass:"header"},[t._v("我的评价")]),t._v(" "),s("el-rate",{attrs:{disabled:t.rateOnlyRead,colors:["#99A9BF","#F7BA2A","#FF9900"],"text-color":"#ff9900","show-score":!0},on:{change:t.rate},model:{value:t.rateValue,callback:function(e){t.rateValue=e},expression:"rateValue"}})],1):t._e()],1)],1),t._v(" "),1===this.$store.getters.userType?s("el-row",[s("el-card",{staticClass:"taskpub-rate-card"},[s("h1",{staticClass:"header"},[t._v("任务分析")]),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("div",{ref:"rateChart",staticStyle:{width:"100%",height:"300px"}})]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",{ref:"workerChart",staticStyle:{width:"100%",height:"300px"}})])],1)],1)],1):t._e(),t._v(" "),"new"===this.state?s("div",{staticClass:"itemRE"},[s("div",{staticClass:"title"},[t._v("\n      相似推荐\n    ")]),t._v(" "),s("div",{staticClass:"similar-task-wrapper"},[t._l(t.similarTasks,function(t,e){return s("div",{key:e,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":t,state:"new"}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e+20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])})],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.similarTasks.length,expression:"similarTasks.length === 0"}],staticClass:"no-similar-task"},[t._v("没有相似的任务")])]):t._e()],1)},staticRenderFns:[]};var gt=s("VU/8")(mt,ft,!1,function(t){s("Uhlq")},null,null).exports,kt=s("Jpv8"),_t={name:"rank",components:{AwardIcon:kt.a,StopCircleIcon:kt.d,CheckIcon:kt.c,ThumbsUpIcon:kt.e,BoxIcon:kt.b},data:function(){return{workerRankType:"积分",workerOptions:["积分","经验","准确度"],publisherRankType:"积分",publisherOptions:["积分","经验","任务数"],workerRank:[],publisherRank:[]}},watch:{workerRankType:function(){switch(this.workerRankType){case"积分":this.getRank("worker","Point");break;case"经验":this.getRank("worker","Exp");break;case"准确度":this.getRank("worker","AccuracyRate")}},publisherRankType:function(){switch(this.publisherRankType){case"积分":this.getRank("pub","Point");break;case"经验":this.getRank("pub","Exp");break;case"任务数":this.getRank("pub","Task")}}},methods:{getAvatar:function(t,e){return t&&"default_avatar.png"!==e?"/show/avatar/"+t+"/"+e:"/static/image/default_avatar.png"},getRank:function(t,e){var s=this,a=0;("worker"===t&&0===this.$store.getters.userType||"pub"===t&&1===this.$store.getters.userType)&&(a=this.$store.getters.id),this.$ajax.get("/rank/"+t+e,{params:{userId:a}}).then(function(e){var a=e.data;"worker"===t?s.workerRank=a.data.rankList:"pub"===t&&(s.publisherRank=a.data.rankList)})}},mounted:function(){this.getRank("worker","Point"),this.getRank("pub","Point")}},bt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rank"},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"rank-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"title"},[t._v("众包工人排行榜")]),t._v(" "),s("el-select",{staticClass:"rank-type-select",staticStyle:{float:"right"},attrs:{size:"small",placeholder:"请选择"},model:{value:t.workerRankType,callback:function(e){t.workerRankType=e},expression:"workerRankType"}},t._l(t.workerOptions,function(t){return s("el-option",{key:t.value,attrs:{value:t}})}))],1),t._v(" "),s("el-table",{staticClass:"rank-table",staticStyle:{width:"100%"},attrs:{data:t.workerRank,fit:""}},[s("el-table-column",{attrs:{type:"index"}}),t._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户",width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("img",{staticClass:"avatar",attrs:{width:"30px",height:"30px",src:t.getAvatar(e.row.id,e.row.avatar)}}),t._v(" "),s("span",{staticClass:"username"},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"points",label:"积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("stop-circle-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.points))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"exp",label:"经验"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("award-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.exp))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"accuracyRate",label:"准确度"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("check-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s((100*e.row.accuracyRate).toFixed(1))+"%")])]}}])})],1)],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"rank-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"title"},[t._v("众包发起者排行榜")]),t._v(" "),s("el-select",{staticClass:"rank-type-select",staticStyle:{float:"right"},attrs:{size:"small",placeholder:"请选择"},model:{value:t.publisherRankType,callback:function(e){t.publisherRankType=e},expression:"publisherRankType"}},t._l(t.publisherOptions,function(t){return s("el-option",{key:t.value,attrs:{value:t}})}))],1),t._v(" "),s("el-table",{staticClass:"rank-table",staticStyle:{width:"100%"},attrs:{data:t.publisherRank}},[s("el-table-column",{attrs:{type:"index"}}),t._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户",width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("img",{staticClass:"avatar",attrs:{width:"30px",height:"30px",src:t.getAvatar(e.row.id,e.row.avatar)}}),t._v(" "),s("span",{staticClass:"username"},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"points",label:"积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("stop-circle-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.points))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"exp",label:"经验"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("award-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.exp))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"taskNum",label:"任务数"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("box-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.taskNum))])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]};var yt=s("VU/8")(_t,bt,!1,function(t){s("74p7")},null,null).exports,xt={name:"admin",mounted:function(){"/board"===localStorage.getItem("fromRoute")?(this.$refs.menu.activeIndex="check-tag",this.$router.push("/check-tag"),localStorage.setItem("fromRoute","")):this.$router.push("/system-state")}},wt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"admin"},[s("div",{staticClass:"left"},[s("el-menu",{ref:"menu",staticClass:"menu",attrs:{router:!0,"default-active":"system-state","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[s("el-menu-item",{attrs:{index:"system-state"}},[s("i",{staticClass:"el-icon-location"}),t._v(" "),s("span",[t._v("查看系统状态")])]),t._v(" "),s("el-menu-item",{attrs:{index:"check-task"}},[s("i",{staticClass:"el-icon-document"}),t._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[t._v("审核发起的任务")])]),t._v(" "),s("el-menu-item",{attrs:{index:"check-tag"}},[s("i",{staticClass:"el-icon-menu"}),t._v(" "),s("span",{attrs:{slot:"title"},slot:"title"},[t._v("审核提交的标注")])])],1)],1),t._v(" "),s("div",{staticClass:"right"},[s("router-view")],1)])},staticRenderFns:[]};var Ct=s("VU/8")(xt,wt,!1,function(t){s("kJFN")},null,null).exports,Tt={name:"check-task",components:{Pagination:ut},data:function(){return{task:{title:"",picNum:"",taskType:1,price:0,description:"",startDate:"",endDate:"",topics:[]},page:1,pageSize:8,totalItemNum:0,taskList:[],images:[],checkTaskdialogVisible:!1}},mounted:function(){this.getSubmittedTasks()},watch:{page:function(){this.getSubmittedTasks()}},methods:{taskType:function(t){return["分类","标框","区域"][t]+"标注"},showDialog:function(t){var e=this;this.checkTaskdialogVisible=!0,this.task=this.taskList[t],this.$ajax.get("/tasks/"+this.task.id).then(function(t){var s=t.data;0===s.code&&(e.images=s.data.images)})},deleteTask:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id===t){this.taskList.splice(e,1),this.totalItemNum--;break}},check:function(t){var e=this;this.$ajax.post("/admin/checkTask/"+this.task.id,this.$qs.stringify({checkResult:t})).then(function(t){0===t.data.code?(e.$message.success("审核成功"),e.deleteTask(e.task.id)):e.$message.error("审核失败")}).catch(function(){e.$message.error("审核失败")}),this.checkTaskdialogVisible=!1},changePage:function(t){this.page=t},getSubmittedTasks:function(){var t=this;this.$ajax.get("/tasks/list",{params:{userId:0,state:"SUBMITTED",size:this.pageSize,page:this.page}}).then(function(e){var s=e.data.data;t.taskList=s.data,t.totalItemNum=s.totalItemNum})}}},It={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"check-task"},[s("el-card",{staticClass:"submitted-tasks"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("待审核的发起任务")])]),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskList,"max-height":"510"}},[s("el-table-column",{attrs:{label:"ID",prop:"id"}}),t._v(" "),s("el-table-column",{attrs:{label:"标题",prop:"title",width:"180"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务量",prop:"picNum"}}),t._v(" "),s("el-table-column",{attrs:{label:"价格",prop:"price"}}),t._v(" "),s("el-table-column",{attrs:{label:"发布时间",prop:"startDate",width:"150px"}}),t._v(" "),s("el-table-column",{attrs:{label:"结束时间",prop:"endDate",width:"150px"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){t.showDialog(e.$index)}}},[t._v("审核\n          ")])]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:"审核任务",visible:t.checkTaskdialogVisible,width:"50%",top:"60px"},on:{"update:visible":function(e){t.checkTaskdialogVisible=e}}},[t.totalItemNum>0?s("div",{staticClass:"detail-wrapper"},[s("el-row",[s("el-col",{attrs:{span:12}},[s("div",[s("label",[t._v("任务名称")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.title))])]),t._v(" "),s("div",[s("label",[t._v("开始日期")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.startDate))])]),t._v(" "),s("div",[s("label",[t._v("图片数量")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.picNum)+"张")])])]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",[s("label",[t._v("任务类型")]),s("span",{staticClass:"text"},[t._v(t._s(t.taskType(t.task.taskType)))])]),t._v(" "),s("div",[s("label",[t._v("结束日期")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.endDate))])]),t._v(" "),s("div",[s("label",[t._v("任务奖励")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.price)+"T币")])])])],1),t._v(" "),s("el-row",[s("div",[s("label",[t._v("任务话题")]),t._v(" "),t._l(t.task.topics,function(e){return s("div",{key:e,staticClass:"topic-wrapper"},[s("el-tag",{attrs:{size:"mini"}},[t._v(t._s(e))])],1)})],2),t._v(" "),s("div",[s("label",[t._v("任务描述")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.description))])])]),t._v(" "),s("el-row",[s("el-carousel",t._l(t.images.length,function(e,a){return s("el-carousel-item",{key:e},[s("img",{attrs:{src:"/show/"+t.task.id+"/"+t.images[a],width:"100%"}})])}))],1)],1):t._e(),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"medium"},on:{click:function(e){t.check(!0)}}},[t._v("通 过")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"medium"},on:{click:function(e){t.check(!1)}}},[t._v("不 通 过")])],1)])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"pagination-wrapper"},[s("pagination",{staticClass:"my-pagination",attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:t.pageSize},on:{changePage:t.changePage}})],1)],1)},staticRenderFns:[]};var $t=s("VU/8")(Tt,It,!1,function(t){s("Raw4")},null,null).exports,Pt={name:"check-tag",components:{Pagination:ut},data:function(){return{page:1,totalItemNum:0,pageSize:9,taskList:[],chosenTask:[]}},mounted:function(){this.getSubmittedTasks()},watch:{page:function(){this.getSubmittedTasks()}},methods:{showTagDetailDialog:function(t){var e=this;this.index=t,this.$ajax.get("/user/"+this.taskList[t].id).then(function(t){var s=t.data;0===s.code&&(localStorage.setItem("taskWorker",b()(s.data)),localStorage.setItem("boardState","check"),e.$router.push("/board"))})},changePage:function(t){this.page=t},handleSelectionChange:function(t){this.chosenTask=t},getSubmittedTasks:function(){var t=this;this.$ajax.get("/user/0/tasks",{params:{size:this.pageSize,page:this.page,state:"SUBMITTED"}}).then(function(e){var s=e.data.data;t.taskList=s.data,t.totalItemNum=s.totalItemNum})},deleteTask:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id===t){this.taskList.splice(e,1);break}this.totalItemNum--},check:function(t){for(var e=this,s=function(s){e.$ajax.post("/admin/checkTag/"+e.chosenTask[s].id,e.$qs.stringify({checkResult:t})).then(function(t){0===t.data.code?(e.$message.success("审核成功"),e.deleteTask(e.chosenTask[s].id),e.chosenTask.splice(s,1)):e.$message.error("审核失败")}).catch(function(){e.$message.error("审核失败")})},a=0;a<this.chosenTask.length;a++)s(a)}}},St={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"check-tag"},[s("el-card",[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("待审核的工人标注")]),t._v(" "),s("div",{staticClass:"check-btn-group"},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.check(1)}}},[t._v("批量通过")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("批量不通过")])],1)]),t._v(" "),s("el-table",{attrs:{data:t.taskList,"max-height":"510"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{label:"工人任务ID",prop:"id"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务名称",prop:"title"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务量",prop:"picNum"}}),t._v(" "),s("el-table-column",{attrs:{label:"提交时间",prop:"endDate"}}),t._v(" "),s("el-table-column",{attrs:{label:"奖励",prop:"price"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"detail-btn",attrs:{type:"plain",icon:"el-icon-back",circle:""},on:{click:function(s){t.showTagDetailDialog(e.$index)}}})]}}])})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"pagination-wrapper"},[s("pagination",{staticClass:"my-pagination",attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:t.pageSize},on:{changePage:t.changePage}})],1)],1)},staticRenderFns:[]};var Et=s("VU/8")(Pt,St,!1,function(t){s("/EJr")},null,null).exports,Nt=s("Icdr");s("Vb+l"),s("GbHy"),s("4UDB"),s("Oq2I"),s("80cc"),s("miEh");var Rt={name:"sys-state",components:{},methods:{drawUserChart:function(){var t=this,e=Nt.init(this.$refs.userChart);e.setOption({title:{text:"用户数量",x:"center"},legend:{show:!0,orient:"horizontal",bottom:0,data:["众包工人","众包发起者"]},tooltip:{trigger:"item",position:"inside",formatter:"{b} : {c} ({d}%)"},series:[{name:"用户数量",type:"pie",radius:"65%",center:["50%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{show:!1},labelLine:{show:!1}}}}]}),window.addEventListener("resize",function(){e.resize()}),this.$ajax.get("/admin/list/worker",{params:{size:9,page:1,keyword:"",sortBy:"全部",isSec:!0}}).then(function(s){var a=s.data;if(0===a.code)var i=a.data;t.$ajax.get("/admin/list/publisher",{params:{size:9,page:1,keyword:"",sortBy:"全部",isSec:!0}}).then(function(t){var s=t.data;if(0===s.code){var a=s.data;e.setOption({series:[{data:[{value:i.totalItemNum,name:"众包工人"},{value:a.totalItemNum,name:"众包发起者"}]}]})}})})},drawTaskChart:function(){var t=Nt.init(this.$refs.taskChart);t.setOption({title:{text:"众包任务数量",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["审核中","进行中","已完成"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:["审核中","进行中","已完成"]}],series:[{data:[10,22,35],type:"bar",label:{normal:{show:!0,position:"inside"}}}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/state").then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=tt()(a),n=[];i.forEach(function(t){n.push(a[t])}),t.setOption({legend:{data:i},yAxis:{data:i},series:[{data:n}]})}})},drawUserGrowthChart:function(){var t=Nt.init(this.$refs.userGrowthChart),e=[["2000-06-05",116],["2000-06-06",129],["2000-06-07",135],["2000-06-08",86],["2000-06-09",73],["2000-06-10",85],["2000-06-11",73],["2000-06-12",68],["2000-06-13",92],["2000-06-14",130],["2000-06-15",245],["2000-06-16",139],["2000-06-17",115],["2000-06-18",111],["2000-06-19",309],["2000-06-20",206],["2000-06-21",137],["2000-06-22",128],["2000-06-23",85],["2000-06-24",94],["2000-06-25",71],["2000-06-26",106],["2000-06-27",84],["2000-06-28",93],["2000-06-29",85],["2000-06-30",73],["2000-07-01",83],["2000-07-02",125],["2000-07-03",107],["2000-07-04",82],["2000-07-05",44],["2000-07-06",72],["2000-07-07",106],["2000-07-08",107],["2000-07-09",66],["2000-07-10",91],["2000-07-11",92],["2000-07-12",113],["2000-07-13",107],["2000-07-14",131],["2000-07-15",111],["2000-07-16",64],["2000-07-17",69],["2000-07-18",88],["2000-07-19",77],["2000-07-20",83],["2000-07-21",111],["2000-07-22",57],["2000-07-23",55],["2000-07-24",60]],s=e.map(function(t){return t[0]}),a=e.map(function(t){return t[1]});t.setOption({visualMap:[{show:!1,type:"continuous",seriesIndex:0,min:0,max:400}],title:[{left:"center",text:"用户增长图"}],grid:{left:"3%",right:"4%",bottom:"5%",containLabel:!0},tooltip:{trigger:"axis"},xAxis:[{data:s}],yAxis:[{name:"人数",splitLine:{show:!1}}],series:[{type:"line",showSymbol:!1,data:a}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/user/tendency",{params:{startDate:"2018-04-26",endDate:(new Date).Format("yyyy-MM-dd"),interval:1}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=[];tt()(a).forEach(function(t){i.push([t,a[t]])});var n=i.map(function(t){return t[0]}),r=i.map(function(t){return t[1]});t.setOption({xAxis:[{data:n}],series:[{data:r}]})}})},drawTaskTypeChart:function(){var t=Nt.init(this.$refs.taskTypeChart);t.setOption({title:{text:"任务话题统计",x:"center"},tooltip:{formatter:"{b}: {c}({d}%)"},legend:{show:!0,orient:"horizontal",bottom:0,data:["动物","植物","人类","医学"]},series:[{type:"pie",radius:"55%",data:[{value:200,name:"动物"},{value:30,name:"植物"},{value:12,name:"人类"},{value:56,name:"医学"}]}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/taskType").then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=tt()(a),n=[];i.forEach(function(t){n.push({name:t,value:a[t]})}),t.setOption({legend:{data:i},series:[{data:n}]})}})}},mounted:function(){this.drawUserGrowthChart(),this.drawUserChart(),this.drawTaskChart(),this.drawTaskTypeChart()}},Dt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sys-state"},[e("el-row",{attrs:{gutter:50}},[e("el-col",{attrs:{span:9}},[e("el-card",{staticClass:"user-amount"},[e("div",{ref:"userChart",staticStyle:{width:"100%",height:"275px"},attrs:{id:"userChart"}})])],1),this._v(" "),e("el-col",{attrs:{span:15}},[e("el-card",[e("div",{ref:"userGrowthChart",staticStyle:{width:"100%",height:"275px"}})])],1)],1),this._v(" "),e("el-row",{attrs:{gutter:50}},[e("el-col",{attrs:{span:9}},[e("el-card",[e("div",{ref:"taskTypeChart",staticStyle:{width:"100%",height:"275px"}})])],1),this._v(" "),e("el-col",{attrs:{span:15}},[e("el-card",[e("div",{ref:"taskChart",staticStyle:{width:"100%",height:"275px"}})])],1)],1)],1)},staticRenderFns:[]};var zt=s("VU/8")(Rt,Dt,!1,function(t){s("z5p/")},null,null).exports,Lt={components:{TaskCard:ot},name:"home-view",data:function(){return{hotTaskIndex:0,recommendTasks:[],hotTasks:[{title:"默认标题"}]}},mounted:function(){this.getHotTasks(),this.getRecommendTasks()},methods:{getBanner:function(t){return t?"/show/"+t.id+"/"+t.picName:"/static/image/default_banner.jpg"},clickTitle:function(t){this.$refs.carousel.setActiveItem(t)},changeCarousel:function(t,e){this.hotTaskIndex=t},getRecommendTasks:function(){var t=this;this.$ajax.get("/recommend/user",{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code?t.recommendTasks=s.data:t.$message.error(s.message)})},getHotTasks:function(){var t=this;this.$ajax.get("/recommend/hotTask",{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code?t.hotTasks=s.data:t.$message.error(s.message)})},enterTask:function(){localStorage.setItem("taskInfo",b()(this.hotTasks[this.hotTaskIndex])),localStorage.setItem("taskState","new"),this.$router.push("/task-detail")}}},Ft={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home-view"},[s("div",{staticClass:"hot-task-wrapper"},[s("el-carousel",{ref:"carousel",staticClass:"hot-task",attrs:{height:"400px","indicator-position":"none",arrow:"never"},on:{change:t.changeCarousel}},[t._l(t.hotTasks,function(e,a){return s("el-carousel-item",{key:a},[s("div",{staticClass:"carousel-item"},[s("img",{attrs:{src:t.getBanner(e),width:"100%"},on:{click:t.enterTask}})])])}),t._v(" "),s("div",{staticClass:"task-info"},t._l(t.hotTasks,function(e,a){return s("h1",{key:a,staticClass:"title",class:{active:a===t.hotTaskIndex},on:{click:function(e){t.clickTitle(a)}}},[t._v(t._s(e.title))])}))],2)],1),t._v(" "),s("div",{staticClass:"recommend-wrapper"},[s("h1",{staticClass:"header"},[t._v("猜你喜欢")]),t._v(" "),s("div",{staticClass:"card-content"},[t._l(t.recommendTasks,function(t,e){return s("div",{key:e,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":t,state:"new"}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e+20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])}),t._v(" "),s("div",{staticClass:"link"},[t._v("没有喜欢的任务？去\n        "),s("router-link",{attrs:{to:"/tasks"}},[t._v("任务中心")]),t._v("\n        看看吧\n      ")],1)],2)])])},staticRenderFns:[]};var Ut=s("VU/8")(Lt,Ft,!1,function(t){s("+H6j")},null,null).exports,Ot={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"white-page"})},staticRenderFns:[]};var Vt=s("VU/8")({name:"white-page"},Ot,!1,function(t){s("SX+A")},null,null).exports,At=s("lbHh"),Mt=s.n(At),jt={name:"signin",data:function(){return{name:"",password:""}},methods:m()({},Object(i.c)({userLogin:"login"}),{login:function(){var t=this;this.$ajax.post("/user/login",{name:this.name,password:this.password}).then(function(e){var s=e.data;0===s.status?(Mt.a.set("login-token",s.result),t.$ajax.get("/user/loginByToken",{params:{name:t.name,password:t.password}}).then(function(e){if(0===(e=e.data).code){var s=e.data,a={userId:s.id,username:s.username,userType:s.userType,avatar:s.avatar};switch(t.userLogin(a),t.$store.getters.userType){case 0:t.$router.push("/home-view");break;case 1:t.$router.push("/myTasks");break;case 2:t.$router.push("/admin")}}})):t.$message.error("登录失败")})}})},Wt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-form",{staticClass:"login-form"},[s("el-form-item",[s("el-input",{staticClass:"username-input",attrs:{placeholder:"手机号/邮箱"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-input",{staticClass:"password-input",attrs:{placeholder:"密码",type:"password"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"login-btn",attrs:{type:"primary",round:""},on:{click:t.login}},[t._v("登录")])],1)],1)},staticRenderFns:[]};var Bt=s("VU/8")(jt,Wt,!1,function(t){s("xj+q")},null,null).exports,qt={name:"sign",data:function(){var t=this;return{step:1,topicList:["动物","植物","车辆","船舶","运动","美食","IT","机械","医学","人类"],signUpForm:{username:"",password:"",passwordAgain:"",phone:"",email:"",userType:0},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符"},{pattern:/^[a-zA-Z](\w){1,9}$/,message:"以字母开头，长度在2-10之间， 只能包含字符、数字和下划线"}],password:[{validator:function(e,s,a){""===s?a(new Error("请输入密码")):(""!==t.signUpForm.password&&t.$refs.signUpForm.validateField("passwordAgain"),a())},trigger:"blur"}],passwordAgain:[{validator:function(e,s,a){""===s?a(new Error("请再次输入密码")):s!==t.signUpForm.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur,change"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:function(t,e,s){!1===/^1[34578]\d{9}$/.test(e)?s(new Error("请输入正确的手机号")):s()},trigger:"blur"}],userType:[{required:!0}]}}},methods:{nextStep:function(){this.step=2},sign:function(){var t=this;this.validate()?this.$ajax.post("/user/sign",this.signUpForm).then(function(e){switch(e.data.code){case 0:t.$router.push("/home"),t.$message.success("注册成功");break;case 6:case 7:t.$message.error("注册失败!"+e.message)}}):this.$message.error("注册信息填写不完整！")},validate:function(){var t=void 0;for(t in this.signUpForm)if(""===this.signUpForm[t]&&"userType"!==t)return!1;return!0}}},Xt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-steps",{attrs:{space:200,active:t.step,"finish-status":"success","align-center":!0,simple:!0}},[s("el-step",{attrs:{title:"步骤 1"}}),t._v(" "),s("el-step",{attrs:{title:"步骤 2"}})],1),t._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],ref:"signUpForm",staticClass:"sign-form",attrs:{"status-icon":"",rules:t.rules,model:t.signUpForm}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.signUpForm.username,callback:function(e){t.$set(t.signUpForm,"username",e)},expression:"signUpForm.username"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:t.signUpForm.password,callback:function(e){t.$set(t.signUpForm,"password",e)},expression:"signUpForm.password"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"passwordAgain"}},[s("el-input",{attrs:{placeholder:"请再次输入密码",type:"password"},model:{value:t.signUpForm.passwordAgain,callback:function(e){t.$set(t.signUpForm,"passwordAgain",e)},expression:"signUpForm.passwordAgain"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"phone"}},[s("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.signUpForm.phone,callback:function(e){t.$set(t.signUpForm,"phone",e)},expression:"signUpForm.phone"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮件地址"},model:{value:t.signUpForm.email,callback:function(e){t.$set(t.signUpForm,"email",e)},expression:"signUpForm.email"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"next-btn",attrs:{type:"primary",round:""},on:{click:t.nextStep}},[t._v("下一步")])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"user-detail-info-card"},[s("el-form",{attrs:{model:t.signUpForm}},[s("el-form-item",{attrs:{label:"我是"}},[s("el-radio-group",{staticClass:"choice",model:{value:t.signUpForm.userType,callback:function(e){t.$set(t.signUpForm,"userType",e)},expression:"signUpForm.userType"}},[s("el-radio",{attrs:{label:0}},[t._v("众包工人")]),t._v(" "),s("el-radio",{attrs:{label:1}},[t._v("众包发起者")])],1)],1),t._v(" "),s("el-form-item",[s("div",{staticClass:"topic-title"},[t._v("我的兴趣是")]),t._v(" "),s("ul",{staticClass:"topic-content"},t._l(t.topicList,function(e,a){return s("li",{key:a,staticClass:"topic-tag"},[s("el-tag",{attrs:{type:"info"}},[t._v(t._s(e))])],1)}))]),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"sign-btn",attrs:{type:"primary",round:""},on:{click:t.sign}},[t._v("注册")])],1)],1)],1)],1)},staticRenderFns:[]};var Yt=s("VU/8")(qt,Xt,!1,function(t){s("1V3h")},null,null).exports;a.default.use(u.a);var Ht=[{path:"/",redirect:"/login"},{path:"/white",component:Vt},{path:"/admin",component:Ct,children:[{path:"/check-task",component:$t},{path:"/check-tag",component:Et},{path:"/system-state",component:zt}]},{path:"/home",component:k,redirect:"/myTasks",children:[{path:"/publish",component:W},{path:"/home-view",component:Ut},{path:"/tasks",component:Z},{path:"/user",component:it},{path:"/myTasks",component:pt},{path:"/task-detail",component:gt},{path:"/rank",component:yt}]},{name:"board",path:"/board",component:O},{path:"/login",component:p,children:[{path:"/",name:"Login",component:Bt},{path:"/sign",name:"Sign",component:Yt}]}],Gt=new u.a({routes:Ht,linkActiveClass:"active"});Gt.beforeEach(function(t,e,s){return"Login"===t.name?r.getters.isLogin?s("/home"):s():"Sign"===t.name?s():r.getters.isLogin?s():s("/login")});var Jt=Gt,Qt=s("mtWM"),Zt=s.n(Qt),Kt=s("1nuA"),te=s.n(Kt),ee=s("zL8q"),se=s.n(ee);s("tvR6");a.default.use(se.a),a.default.prototype.$qs=te.a,a.default.prototype.$ajax=Zt.a,a.default.config.productionTip=!1,new a.default({el:"#app",router:Jt,components:{App:c},template:"<App/>"})},OJiU:function(t,e){},OUxK:function(t,e){},PyXk:function(t,e){},QM0R:function(t,e){},Raw4:function(t,e){},"SX+A":function(t,e){},"T/OL":function(t,e){},Tmu6:function(t,e){},Uhlq:function(t,e){},Usuq:function(t,e){},bHyx:function(t,e){},fjIZ:function(t,e){Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[s]:("00"+e[s]).substr((""+e[s]).length)));return t}},jtC2:function(t,e){},kJFN:function(t,e){},kmD7:function(t,e){},nc7f:function(t,e){},tvR6:function(t,e){},"xj+q":function(t,e){},"z5p/":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.0abae200acb5ea67f4ab.js.map