webpackJsonp([1],{"/EJr":function(t,e){},0:function(t,e){},1:function(t,e){},"4Uxh":function(t,e){},"6PsS":function(t,e){t.exports="data:image/png;base64,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"},"74p7":function(t,e){},"92qD":function(t,e){},"9cIw":function(t,e,s){t.exports=s.p+"static/img/pure-logo.fc4be88.png"},Dg3x:function(t,e){},E7G9:function(t,e){},GoAp:function(t,e){},IrNe:function(t,e){},MzPN:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("7+uW"),i=s("NYxO"),n={state:{isLogin:!1,id:0,userType:0,username:"游客",avatar:"default_avatar.png"},getters:{isLogin:function(t){return t.isLogin},id:function(t){return t.id},userType:function(t){return t.userType},username:function(t){return t.username},avatar:function(t){return t.avatar}},actions:{},mutations:{login:function(t,e){t.isLogin=!0,t.id=e.userId,t.userType=e.userType,t.username=e.username,t.avatar=e.avatar},logout:function(t){t.isLogin=!1},changeAvatar:function(t,e){t.avatar=e}}};a.default.use(i.a);var o=new i.a.Store({modules:{User:n}}),r={name:"App",store:o,data:function(){return{}},methods:{}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view",{staticClass:"main-view"})],1)},staticRenderFns:[]};var c=s("VU/8")(r,l,!1,function(t){s("PyXk")},null,null).exports,u=s("/ocq"),d={name:"login",beforeRouteUpdate:function(t,e,s){console.log("here"),s()}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login"},[e("div",{staticClass:"form-wrapper"},[e("div",{staticClass:"form"},[e("div",{staticClass:"tab-head",attrs:{slot:"head"},slot:"head"},[e("img",{staticClass:"logo",attrs:{src:"/static/image/pure-logo.png",width:"85px",height:"84px"}}),this._v(" "),e("router-link",{attrs:{to:"/login"}},[this._v("登录")]),this._v(" "),e("router-link",{attrs:{to:"/sign"}},[this._v("注册")])],1),this._v(" "),e("router-view",{staticClass:"form-body"})],1)])])},staticRenderFns:[]};var h=s("VU/8")(d,p,!1,function(t){s("bHyx")},null,null).exports,v=s("Dd8w"),f=s.n(v),m={name:"home",data:function(){return{keyword:""}},computed:f()({},Object(i.b)(["username","userType","avatar","id"]),{getAvatar:function(){return"default_avatar.png"===this.$store.getters.avatar?"/static/image/default_avatar.png":"/show/avatar/"+this.$store.getters.id+"/"+this.$store.getters.avatar}}),methods:f()({},Object(i.c)({userLogout:"logout"}),{refresh:function(){this.$router.push("/white"),this.$router.go(-1)},handleCommand:function(t){switch(t){case"logout":this.userLogout(),this.$router.push("/login");break;case"user":this.$router.push("/user")}},search:function(){this.$router.push("/tasks"),this.$refs.child.getTaskInfos(1)}})},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("header",[s("nav",{staticClass:"head-nav"},[s("div",{staticClass:"fl"},[t._m(0),t._v(" "),s("div",{staticClass:"links"},[0===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/home-view"},nativeOn:{click:function(e){return t.refresh(e)}}},[t._v("首页")]):t._e(),t._v(" "),0===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/tasks"},nativeOn:{click:function(e){return t.refresh(e)}}},[t._v("任务中心")]):t._e(),t._v(" "),1===t.userType?s("router-link",{staticClass:"link",attrs:{to:"/publish"}},[t._v("发布任务")]):t._e(),t._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/myTasks"}},[t._v("我的任务")]),t._v(" "),s("router-link",{staticClass:"link",attrs:{to:"/rank"}},[t._v("排行榜")])],1),t._v(" "),0===this.$store.getters.userType?s("el-input",{ref:"searchInput",staticClass:"search-input",attrs:{placeholder:"搜索想要的任务",size:"small","suffix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.search(e):null}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):t._e()],1),t._v(" "),s("div",{staticClass:"fr"},[s("i",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"el-icon-bell"}),t._v(" "),s("div",{staticClass:"user-wrapper"},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatar,width:"30px",height:"30px"}}),t._v(" "),s("el-dropdown",{staticClass:"username",attrs:{size:"medium",placement:"bottom"},on:{command:t.handleCommand}},[s("span",{staticClass:"el-dropdown-link"},[t._v("\n              "+t._s(t.username)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item"),t._v(" "),s("el-dropdown-item",{attrs:{command:"user"}},[t._v("个人主页")]),t._v(" "),s("el-dropdown-item",{attrs:{divided:"",command:"logout"}},[t._v("退出登录")])],1)],1)],1)])])]),t._v(" "),s("div",{staticClass:"home-view"},[s("router-view",{ref:"child",attrs:{keyword:t.keyword}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"brand",attrs:{href:"/#/home"}},[e("img",{staticClass:"brand-img",attrs:{src:"/static/image/logo.png",width:"169",height:"44",alt:""}})])}]};var k=s("VU/8")(m,g,!1,function(t){s("E7G9")},null,null).exports,_=s("mvHQ"),y=s.n(_),b=s("c/Tr"),w=s.n(b),x=s("M4fF"),C=s.n(x),T={name:"question-no",data:function(){return{active:0,size:0,questions:[]}},methods:{select:function(t){this.active=t,this.$emit("change-active",t+1)},setSize:function(t){this.size=t,this.refresh()},pass:function(t,e){this.questions[e].state=t},result:function(){var t=0,e=!0;return this.questions.forEach(function(s){1===s.state&&t++,2===s.state&&(e=!1)}),e?t/this.size:null},refresh:function(){this.questions=[];for(var t=0;t<this.size;t++)this.questions.push({state:2})}},mounted:function(){this.refresh()}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"question-no"},t._l(t.questions,function(e,a){return s("div",{key:a,staticClass:"no-block",class:{active:t.active===a,pass:1===e.state,reject:0===e.state},on:{click:function(e){t.select(a)}}},[t._v(t._s(a+1)+"\n  ")])}))},staticRenderFns:[]};var I=!1,P=!1,$=!1,E=!1,N=!1,R={},A={startPosition:{x:0,y:0},endPosition:{x:0,y:0}},L={},z=0,U={name:"TagBoard",data:function(){return{activeIndex:-1,index:0,imageUrl:"https://i1.mifile.cn/f/i/18/mitv4A/40/build.jpg",tags:[{id:0,startPosition:{x:.3,y:.3},endPosition:{x:.5,ey:.5},tagType:1,penPoints:[],descType:0,mapDesc:{},singleDesc:"opo",color:"blue"}],shade:!1,deleteToolTips:[!1,!1,!1,!1],boardState:"",singleDesc:"",overall:"",showMenu:!1,showEdit:!1,showShade:!1,drawMode:1,options:["脸","手"],taskWorker:{taskType:1,desc:"",labels:[],images:[{filename:"",tags:[]}]}}},components:{QuestionNo:s("VU/8")(T,S,!1,function(t){s("GoAp")},null,null).exports},computed:{overallDesc:function(){for(var t=0;t<this.tags.length;t++){var e=this.tags[t];if(0===Number(e.tagType))return console.log(e.singleDesc),e.singleDesc}return"无"},getTips:function(){var t=["使用<kbd>←</kbd>和<kbd>→</kbd>快捷切换图片","使用数字键<kbd>1</kbd><kbd>2</kbd>...快速选择标注文字","使用<kbd>enter</kbd>键, 快速确认一个标注"];return t[Math.floor(Math.random()*t.length)]}},mounted:function(){var t=this,e=this;this.$refs.tagContent.oncontextmenu=function(){return!1},window.addEventListener("resize",this.resizeImg),setTimeout(function(){t.resizeImg()},50),window.onbeforeunload=function(t){return(t=t||window.event)&&(t.returnValue="Sure?"),"Sure?"},document.onkeyup=function(t){if(37===t.keyCode)console.log(1),e.changeIndex(e.index);else if(39===t.keyCode)console.log(2),e.changeIndex(e.index+2);else if(e.showEdit&&t.keyCode>=48&&t.keyCode<=57){var s=t.keyCode-49;s>=0&&s<e.options.length&&(e.singleDesc=e.options[s])}else e.showEdit&&13===t.keyCode&&e.confirm()};var s=localStorage.getItem("taskWorker"),a=localStorage.getItem("boardState");a&&(this.boardState=a),this.$nextTick(function(){if(s){if(t.taskWorker=JSON.parse(s),"check"===t.boardState){var e=t.taskWorker.images;if(e.length>=10){var a=Math.round(Math.sqrt(e.length));a=a<10?10:a,e=C.a.shuffle(e).slice(0,a)}t.taskWorker.images=e}if(t.$refs.questionNo.setSize(t.taskWorker.images.length),t.taskWorker.images.forEach(function(e,s){null===e.tags&&(e.tags=[]),"edit"===t.boardState&&t.$refs.questionNo.pass(2-(e.tags.length>0),s)}),t.imageUrl="/show/"+t.taskWorker.taskId+"/"+t.taskWorker.images[0].filename,t.tags=t.taskWorker.images[0].tags,"edit"===t.boardState){for(var i=0;i<t.tags.length-t.deleteToolTips.length;i++)t.deleteToolTips.push(!1);t.$ajax.get("/tasks/"+t.taskWorker.taskId).then(function(e){var s=e.data;0===s.code&&(t.options=s.data.options)})}}}),"edit"===this.boardState?this.$notify({title:"小贴士",dangerouslyUseHTMLString:!0,message:this.getTips}):"view-result"===this.boardState&&this.$notify({title:"小贴士",dangerouslyUseHTMLString:!0,message:'<span style="display: inline-block;width: 13px;height: 13px; background: rgba(255,0,0,0.3)"></span>  说明标注正确<br><span style="display: inline-block;width: 13px;height: 13px; background: rgba(0,255,0,0.3)"></span>  说明标注错误<br><span style="display: inline-block;width: 13px;height: 13px; background: rgba(0,0,255,0.3)"></span>  说明遗漏标注'})},methods:{check:function(t){this.$refs.questionNo.pass(t,this.index)},finishCheck:function(){var t=this,e=this.$refs.questionNo.result();null!==e?this.$ajax.post("/admin/checkTag/"+this.taskWorker.id,this.$qs.stringify({checkResult:e})).then(function(e){0===e.data.code?(localStorage.setItem("boardState",null),localStorage.setItem("fromRoute","/board"),t.$router.go(-1),t.$message.success("审核成功")):t.$message.error("审核失败")}):this.$message.error("还有未审核的题!")},submit:function(t){var e=this,s="";s="PROCESSING"===t?"确认保存当前任务？（保存后可在我的任务中继续完成任务）":"确认已完成所有的标注任务?(提交后将不能再次编辑）",this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.taskWorker.taskState=t,e.$ajax.post("/user/tasks",e.taskWorker).then(function(t){var s=t.data;0===s.code?(e.$message({type:"success",message:"成功!"}),"SUBMITTED"===e.taskWorker.taskState&&e.$alert("恭喜你完成了本次任务! <br> 这 "+s.data+" T币就作为小奖励啦， <br> 等待任务通过后还会有更多积分奖励哦!","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,callback:function(t){}}),e._cleanExitQuestion(),e.$router.push("/myTasks")):e.$message.error("失败，服务器开小差啦")}).catch(function(){e.$message.error("失败，服务器开小差啦")})}).catch(function(){console.log("hhh"),e.$message({type:"info",message:"已取消提交"})})},giveUp:function(){var t=this;this.$confirm("确认放弃本次标注任务？（标注结果将不会保存）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t._cleanExitQuestion(),t.$router.push("/home-view")}).catch(function(){})},back:function(){this.$router.go(-1)},cancelDelete:function(t){this.deleteToolTips[t]=!1,this.$set(this.deleteToolTips,t,!1)},changeIndex:function(t){t<=0?this.$message.error("这已经是第一张图片了！"):t>this.taskWorker.images.length?this.$message.error("这已经是最后一张图片了！"):(t-=1,this.index=t,this.imageUrl="/show/"+this.taskWorker.taskId+"/"+this.taskWorker.images[t].filename,this.tags=this.taskWorker.images[t].tags)},confirmOverall:function(){""===this.overall.trim()?this.$message.error("空白标注，请重新输入"):(this.tags.push({tagType:0,id:0,descType:0,singleDesc:this.overall}),this.$message.success("标注成功"),this.refreshQuestionNo(this.index))},adjZIndex:function(){var t=w()(document.getElementsByClassName("tag")),e=[];t.forEach(function(t){var s=t.offsetWidth*t.offsetHeight;e.push(s)}),t.forEach(function(t){var s=t.offsetWidth*t.offsetHeight,a=0;e.forEach(function(t){s<=t&&a++}),t.style.zIndex=a})},selectMode:function(t){this.drawMode=Number(t)},resizeImg:function(){var t=this.$refs.img.naturalWidth,e=this.$refs.img.naturalHeight,s=this.$refs.tagContent;this.$refs.imgBody.style.height=e*s.offsetWidth/t+"px"},clickTag:function(t,e,s){if(3===t.which)return this.$refs.dropMenu.style.left=t.clientX+"px",this.$refs.dropMenu.style.top=t.clientY+"px",this.showMenu=!0,void(this.activeIndex=e);I=!0,this.showMenu=!1,this.showShade=!0,$=!0,this.activeIndex=e;var a=this.$refs.tagContent;R={x:this._offset(a).left,y:this._offset(a).top,cx:t.clientX,cy:t.clientY,w:a.offsetWidth,h:a.offsetHeight},A.startPosition.x=s.startPosition.x,A.startPosition.y=s.startPosition.y,A.endPosition.x=s.endPosition.x,A.endPosition.y=s.endPosition.y,L=s},move:function(t){1===this.drawMode?this.moveTag(t):this.movePoint(t)},movePoint:function(t){if(I&&2===Number(this.drawMode)){N||(this.tags.push({tagType:2,startPosition:{x:0,y:0},endPosition:{x:0,y:0},penPoints:[],descType:0,singleDesc:"",mapDesc:{}}),N=!0,this.activeIndex=this.tags.length-1),this.showShade=!1;var e=this.$refs.tagContent;R={x:this._offset(e).left,y:this._offset(e).top,cx:t.clientX,cy:t.clientY,w:e.offsetWidth,h:e.offsetHeight};var s={x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h,tagType:this.drawMode};this.tags[this.activeIndex].penPoints.push(s)}},moveTag:function(t){if(I&&$)L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w,L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h,L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w,L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h,L.startPosition.y<0&&(L.startPosition.y=0),L.startPosition.x<0&&(L.startPosition.x=0),L.endPosition.y<0&&(L.endPosition.y=0),L.startPosition.x<0&&(L.endPosition.x=0),L.endPosition.y>1&&(L.endPosition.y=1),L.endPosition.x>1&&(L.endPosition.x=1),L.startPosition.y>1&&(L.startPosition.y=1),L.startPosition.x>1&&(L.startPosition.x=1);else if(E&&I)1===z?(A.startPosition.x>A.endPosition.x?L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w:L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w,A.startPosition.y>A.endPosition.y?L.endPosition.y=A.endPosition.y+(t.clientX-R.cx)/R.w:L.startPosition.y=A.startPosition.y+(t.clientX-R.cx)/R.w):2===z?A.startPosition.y>A.endPosition.y?L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h:L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h:3===z?(A.startPosition.x>A.endPosition.x?L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w:L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w,A.startPosition.y>A.endPosition.y?L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h:L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h):4===z?A.startPosition.x>A.endPosition.x?L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w:L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w:5===z?A.startPosition.x>A.endPosition.x?L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w:L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w:6===z?(A.startPosition.x>A.endPosition.x?L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w:L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w,A.startPosition.y>A.endPosition.y?L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h:L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h):7===z?A.startPosition.y>A.endPosition.y?L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h:L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h:8===z&&(A.startPosition.x>A.endPosition.x?L.startPosition.x=A.startPosition.x+(t.clientX-R.cx)/R.w:L.endPosition.x=A.endPosition.x+(t.clientX-R.cx)/R.w,A.startPosition.y>A.endPosition.y?L.startPosition.y=A.startPosition.y+(t.clientY-R.cy)/R.h:L.endPosition.y=A.endPosition.y+(t.clientY-R.cy)/R.h);else if(I)if(N)this.activeIndex=this.tags.length-1,this.showShade=!0,this.tags[this.tags.length-1].endPosition.x=this.tags[this.tags.length-1].startPosition.x+(t.clientX-R.cx)/R.w,this.tags[this.tags.length-1].endPosition.y=this.tags[this.tags.length-1].startPosition.y+(t.clientY-R.cy)/R.h;else{var e=this.$refs.tagContent;R={x:this._offset(e).left,y:this._offset(e).top,cx:t.clientX,cy:t.clientY,w:e.offsetWidth,h:e.offsetHeight};var s={id:0,startPosition:{x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h},endPosition:{x:(t.clientX-R.x-this.$refs.colLeft.offsetWidth)/R.w,y:(t.clientY-R.y)/R.h},tagType:this.drawMode};0===this.taskWorker.taskType&&(s.descType=1,s.mapDesc={},this.taskWorker.labels.forEach(function(t){s.mapDesc[t]=""})),this.tags.push(s),this.deleteToolTips.push(!1),L=s,N=!0}},clickSpot:function(t,e,s){I=!0,E=!0,this.showShade=!0;var a=this.$refs.tagContent;R={x:this._offset(a).left,y:this._offset(a).top,cx:t.clientX,cy:t.clientY,w:a.offsetWidth,h:a.offsetHeight},A.startPosition.x=s.startPosition.x,A.startPosition.y=s.startPosition.y,A.endPosition.x=s.endPosition.x,A.endPosition.y=s.endPosition.y,z=e,L=s},finishTag:function(t){I=!1,$=!1,E=!1,N&&(this.showEdit=!0,N=!1,this.activeIndex=this.tags.length-1),this.showShade=!1,this.adjZIndex()},clickContent:function(){I=!0,this.activeIndex=-1,this.showMenu=!1},cancelConfirm:function(){this.showEdit=!1,P?(P=!1,console.log(A.mapDesc),this.tags[this.activeIndex].mapDesc=A.mapDesc):(this.tags.splice(this.activeIndex,1),this.activeIndex=-1)},confirm:function(){if(0===this.taskWorker.taskType);else{if(""===this.singleDesc.trim())return void this.$message.error("空白的标注，请重新输入");this.tags[this.activeIndex].singleDesc=this.singleDesc,this.tags[this.activeIndex].descType=0,this.singleDesc=""}this.tags[this.activeIndex].id=0,this.showEdit=!1,this.refreshQuestionNo(this.index),P=!1},deleteTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeIndex;this.deleteToolTips[t]=!1,this.tags.splice(t,1),this.showMenu=!1,this.refreshQuestionNo(this.index),this.activeIndex=-1},editTag:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.activeIndex;P=!0,this.activeIndex=t,this.showEdit=!0,0!==this.taskWorker.taskType?this.singleDesc=this.tags[t].singleDesc:A=JSON.parse(y()(this.tags[t])),this.showMenu=!1},refreshQuestionNo:function(t){this.$refs.questionNo.pass(2-(this.tags.length>0),t)},_offset:function(t){var e=void 0,s=void 0;for(e=0,s=0;t.offsetParent;)e+=t.offsetTop,s+=t.offsetLeft,t=t.offsetParent;return{top:e,left:s}},_cleanExitQuestion:function(){window.onbeforeunload=function(t){},document.onkeyup=function(t){}},getBackgroundColor:function(t){var e=this.tags[t].color;return void 0===e||null===e?"rgba(255,0,0,0.3)":"red"===e?"rgba(255,0,0,0.3)":"green"===e?"rgba(0,255,0,0.3)":"blue"===e?"rgba(0,0,255,0.3)":void 0}}},D={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"tag-board"}},[s("div",{ref:"colLeft",staticClass:"col-left"},["edit"===t.boardState?s("div",{directives:[{name:"show",rawName:"v-show",value:"无"===t.overallDesc&&!1,expression:"overallDesc === '无' && false"}]},[s("h1",{staticClass:"title"},[t._v("整体描述")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"overall-desc"},[s("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入对图片的整体描述"},model:{value:t.overall,callback:function(e){t.overall=e},expression:"overall"}}),t._v(" "),s("el-button",{attrs:{type:"plain",size:"small"},on:{click:t.confirmOverall}},[t._v("确认")])],1)])]):t._e(),t._v(" "),s("div",{staticClass:"results"},[s("h1",{staticClass:"title"},[t._v("标注结果")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"overall-wrapper"},[s("h1",{staticClass:"label"},[t._v("整体描述")]),t._v(" "),s("p",{staticClass:"overall-text"},[t._v(t._s(t.overallDesc))])]),t._v(" "),s("div",{staticClass:"part-wrapper"},[s("h1",{staticClass:"label"},[t._v("局部标注")]),t._v(" "),0===t.tags.length?s("div",[t._v("无")]):t._e(),t._v(" "),s("ul",{staticClass:"tag-list"},t._l(t.tags,function(e,a){return 0!==e.tagType?s("li",{key:a,staticClass:"tag-item"},[0===e.descType?s("div",{staticClass:"single"},[s("span",[t._v(t._s(a+1)+". "+t._s(e.singleDesc))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"edit"===t.boardState,expression:"boardState === 'edit'"}],staticClass:"icon-group"},[s("i",{staticClass:"el-icon-edit",on:{click:function(e){t.editTag(a)}}}),t._v(" "),s("el-popover",{attrs:{placement:"right",width:"160"},model:{value:t.deleteToolTips[a],callback:function(e){t.$set(t.deleteToolTips,a,e)},expression:"deleteToolTips[index]"}},[s("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("确定删除这个标注吗？")]),t._v(" "),s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.cancelDelete(a)}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.deleteTag(a)}}},[t._v("确定")])],1),t._v(" "),s("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)]):t._e(),t._v(" "),1===e.descType?s("div",{staticClass:"map"},[s("div",{staticStyle:{"margin-bottom":"5px"}},[t._v(t._s(a+1))]),t._v(" "),t._l(Object.keys(e.mapDesc),function(a,i){return s("div",{key:i,staticStyle:{"margin-bottom":"3px"}},[t._v(t._s(a)+": "+t._s(e.mapDesc[a])+"\n                ")])}),t._v(" "),s("div",{staticClass:"icon-group"},[s("i",{staticClass:"el-icon-edit",on:{click:function(e){t.editTag(a)}}}),t._v(" "),s("el-popover",{attrs:{placement:"right",width:"160"},model:{value:t.deleteToolTips[a],callback:function(e){t.$set(t.deleteToolTips,a,e)},expression:"deleteToolTips[index]"}},[s("p",{staticStyle:{"margin-bottom":"10px"}},[t._v("确定删除这个标注吗？")]),t._v(" "),s("div",{staticStyle:{"text-align":"right"}},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.cancelDelete(a)}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.deleteTag(a)}}},[t._v("确定")])],1),t._v(" "),s("i",{staticClass:"el-icon-delete",attrs:{slot:"reference"},slot:"reference"})])],1)],2):t._e()]):t._e()}))])])])]),t._v(" "),s("div",{staticClass:"col-mid"},["edit"!==t.boardState?s("div",{staticClass:"click-shade",staticStyle:{"z-index":"10000"},on:{mouseup:function(t){},mousemove:function(t){},mousedown:function(t){}}}):t._e(),t._v(" "),s("div",{staticClass:"img-box"},[s("div",{staticClass:"img-body-wrapper"},[s("span",{ref:"imgBody",staticClass:"img-body"},[s("img",{ref:"img",staticClass:"img",attrs:{src:t.imageUrl,width:"100%",height:"100%"}}),t._v(" "),s("div",{ref:"tagContent",staticClass:"tag-content",on:{mouseup:function(e){t.finishTag(e)},mousemove:function(e){t.move(e)},mousedown:t.clickContent}},[s("div",{staticClass:"tag-wrapper"},t._l(t.tags,function(e,a){return 1===Number(e.tagType)?s("div",{key:a,staticClass:"tag",class:{active:a===t.activeIndex},style:{left:100*(e.endPosition.x-e.startPosition.x>0?e.startPosition.x:e.endPosition.x)+"%",top:100*(e.endPosition.y-e.startPosition.y>0?e.startPosition.y:e.endPosition.y)+"%",width:100*Math.abs(e.endPosition.x-e.startPosition.x)+"%",height:100*Math.abs(e.endPosition.y-e.startPosition.y)+"%",background:t.showShade?"rgba(0, 0, 0, 0)":t.getBackgroundColor(a)},on:{mousedown:function(s){s.stopPropagation(),t.clickTag(s,a,e)}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!(t.showShade&&t.activeIndex===a),expression:"!(showShade && activeIndex === index)"}],staticClass:"tag-text"},[t._v(t._s(e.singleDesc))]),t._v(" "),s("div",{staticClass:"spot-wrapper"},t._l(8,function(a){return s("i",{key:a,staticClass:"spot",attrs:{id:"spot"},on:{mousedown:function(s){s.stopPropagation(),t.clickSpot(s,a,e)}}})})),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showShade&&t.activeIndex===a,expression:"showShade && activeIndex === index"}],staticClass:"em-wrapper"},t._l(4,function(t){return s("div",{key:t,staticClass:"em"})}))]):t._e()})),t._v(" "),2===t.taskWorker.taskType?s("div",{staticClass:"point-tag-wrapper"},t._l(t.tags,function(e,a){return 2===Number(e.tagType)?s("div",{key:a,staticClass:"point-tag"},t._l(e.penPoints,function(t,e){return s("div",{key:e,staticClass:"point",style:{left:100*t.x+"%",top:100*t.y+"%"}})})):t._e()})):t._e()])])]),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showMenu,expression:"showMenu"}],ref:"dropMenu",staticClass:"drop-menu"},[s("div",[s("div",{staticClass:"btn delete-btn",on:{click:t.deleteTag}},[t._v("删除")]),t._v(" "),s("div",{staticClass:"btn edit-btn",on:{click:t.editTag}},[t._v("编辑")])])])]),t._v(" "),s("transition",{staticClass:"animated",attrs:{"enter-active-class":"bounceIn","leave-active-class":"bounceOut"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showEdit,expression:"showEdit"}],staticClass:"input-box-wrapper"},[s("div",{staticClass:"input-box"},[s("div",{staticClass:"header"},[s("span",{staticClass:"title"},[t._v("编辑内容")]),t._v(" "),s("i",{staticClass:"el-icon-close close-btn",on:{click:t.cancelConfirm}})]),t._v(" "),s("div",{staticClass:"content"},[2===t.taskWorker.taskType?s("div",[s("el-input",{attrs:{size:"small"},model:{value:t.singleDesc,callback:function(e){t.singleDesc=e},expression:"singleDesc"}})],1):t._e(),t._v(" "),1===t.taskWorker.taskType?s("div",{staticStyle:{margin:"20px 0","text-align":"center"}},[s("el-radio-group",{ref:"options",model:{value:t.singleDesc,callback:function(e){t.singleDesc=e},expression:"singleDesc"}},t._l(t.options,function(e){return s("el-radio",{key:e,attrs:{label:e}},[t._v(t._s(e)+"\n                ")])}))],1):t._e(),t._v(" "),0===t.taskWorker.taskType&&t.activeIndex>=0?s("div",t._l(t.taskWorker.labels,function(e,a){return s("div",{key:a},[s("span",[t._v(t._s(e))]),t._v(" "),s("el-input",{staticStyle:{margin:"10px 0"},attrs:{size:"small"},model:{value:t.tags[t.activeIndex].mapDesc[e],callback:function(s){t.$set(t.tags[t.activeIndex].mapDesc,e,s)},expression:"tags[activeIndex].mapDesc[label]"}})],1)})):t._e(),t._v(" "),s("div",{staticClass:"my-btn-group"},[s("el-button",{staticClass:"btn confirm-btn",attrs:{size:"small",type:"primary"},on:{click:t.confirm}},[t._v("确定")]),t._v(" "),s("el-button",{staticClass:"btn cancel-btn",attrs:{size:"small"},on:{click:t.cancelConfirm}},[t._v("取消")])],1)])])])])],1),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"tagutil-wrapper"},[s("div",{staticClass:"task-info"},[s("h1",{staticClass:"title"},[t._v("任务信息")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"label"},[t._v("任务描述")]),t._v(" "),s("div",{staticClass:"desc"},[t._v(t._s(t.taskWorker.description))]),t._v(" "),s("question-no",{ref:"questionNo",staticClass:"question-no",on:{"change-active":t.changeIndex}}),t._v(" "),"edit"===t.boardState?s("div",{staticClass:"edit-btn-group"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.submit("SUBMITTED")}}},[t._v("提交")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.submit("PROCESSING")}}},[t._v("保存")]),t._v(" "),s("el-button",{attrs:{type:"plain",size:"mini"},on:{click:t.giveUp}},[t._v("放弃")])],1):t._e(),t._v(" "),"view-result"===t.boardState?s("div",{staticClass:"view-btn-group"},[s("el-button",{attrs:{type:"danger",size:"mini"},on:{click:t.back}},[t._v("返回")])],1):t._e(),t._v(" "),"check"===t.boardState?s("div",{staticClass:"read-btn-group"},[s("el-button",{attrs:{type:"plain",size:"small"},on:{click:function(e){t.check(1)}}},[t._v("通过")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(e){t.check(0)}}},[t._v("拒绝")]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.finishCheck}},[t._v("完成")])],1):t._e()],1)]),t._v(" "),"edit"===t.boardState?s("div",{staticClass:"utils"},[s("h1",{staticClass:"title"},[t._v("工具区")]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"btn-group"},[s("el-radio-group",{ref:"utils",attrs:{size:"small"},model:{value:t.drawMode,callback:function(e){t.drawMode=e},expression:"drawMode"}},[s("el-radio-button",{attrs:{label:1,disabled:2==t.taskWorker.taskType},on:{click:function(e){t.selectMode(1)}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("矩形\n              ")]),t._v(" "),s("el-radio-button",{attrs:{label:2,disabled:2!==t.taskWorker.taskType},on:{click:function(e){t.selectMode(2)}}},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v("铅笔\n              ")])],1)],1)])]):t._e()])])])},staticRenderFns:[]};var F=s("VU/8")(U,D,!1,function(t){s("dCXo")},null,null).exports,M=s("9WQZ"),O=s.n(M),W=s("Xxa5"),j=s.n(W),V=s("fZjL"),B=s.n(V),q=s("exGp"),H=s.n(q),X=(s("fjIZ"),s("WgY6")),Y=s.n(X),Q={name:"publish",data:function(){return{uploadData:{id:0},endDateOpt:this.disabledDate(),filelist:[],task:{userId:this.$store.getters.id,title:"",description:"",taskType:1,endDate:"",price:0,numPerPic:0,labels:[],topics:[],startDate:(new Date).Format("yyyy-MM-dd hh:mm"),images:[],options:[]},inputVisible:!1,inputValue:"",optionValue:"",topics:[{value:"动物"},{value:"植物"},{value:"车辆"},{value:"船舶"},{value:"运动"},{value:"美食"},{value:"IT"},{value:"机械"},{value:"医学"},{value:"人类"}],picSum:0}},watch:{"task.numPerPic":function(){this.refreshPrice()}},methods:{checkPrice:function(){var t=H()(j.a.mark(function t(e){var s,a;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.name.substr(e.name.lastIndexOf(".")+1),a=[],"zip"!==s){t.next=5;break}return t.next=5,Y.a.loadAsync(e).then(function(t){B()(t.files).forEach(function(t){if(-1===t.indexOf("/")){var e=t.substr(t.lastIndexOf(".")+1);"jpg"!==e&&"png"!==e||(a.push(t),console.log(t))}}),console.log(a.length),console.log("解压完成")});case 5:"zip"===s?this.picSum+=a.length:this.picSum++,console.log("picSum:"+this.picSum);case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleOptionClose:function(t){this.task.options.splice(t,1)},refreshPrice:function(){this.task.price=this.task.numPerPic<this.task.price?this.task.price:this.task.numPerPic},disabledDate:function(){return{disabledDate:function(t){return t.getTime()<Date.now()}}},addLabel:function(){this.task.labels.push("")},deleteLabel:function(t){this.task.labels.splice(t,1)},addImage:function(t,e){console.log(t),this.checkSize(t)||this.removeImage(t);var s=this.$refs.uploadFile.uploadFiles,a=t.name.substr(t.name.lastIndexOf(".")+1);"jpg"!==a&&"png"!==a&&"zip"!==a&&(this.$message.error("文件类型只支持jpg、png和zip哦"),this.$refs.uploadFile.abort(t),s.splice(s.indexOf(t),1),this.removeImage(t));for(var i=0,n=0;n<s.length;n++)if(s[n].name===t.name){if(1===i)return this.$message.error("请不要上传同名图片！"),this.$refs.uploadFile.abort(t),void s.splice(s.indexOf(t),1);i++}this.task.images.push(t.name)},removeImage:function(t){for(var e=this.$refs.uploadFile.uploadFiles,s=0;s<e.length;s++)if(e[s].name===t.name)return console.log(s),this.task.images.splice(s,1),void console.log(this.task.images)},checkSize:function(t){var e=t.size/1024/1024<20;return e||this.$message.error("上传文件大小不能超过 20 MB!"),e},validate:function(){var t=this.task;return!(""===t.title||""===t.description||0===t.taskType&&0===t.labels.length||""===t.endDate||t.price<=0||0===t.images.length||0===t.options.length)},publish:function(){var t=this;this.validate()?(this.$refs.uploadFile.submit(),this.$ajax.get("/user/info/"+this.$store.getters.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;if(console.log(t.picSum),console.log(t.task.price),console.log(a.points),t.picSum*t.task.price>a.points)return void t.$message.error("积分不足，请充值");t.task.price*=t.task.images.length,t.$ajax.post("/tasks/new",t.task).then(function(e){0===e.data.code?(t.$message.success("提交成功，请等待审核"),t.uploadData.id=e.data.data.id,t.$refs.uploadFile.submit(),t.$router.push("/home")):t.$message.error("提交失败")}).catch(function(){t.$message.error("提交失败")})}}).catch(function(){t.$message.error("获取用户信息失败")})):this.$message.error("信息填写不完整")},cancel:function(){var t=this;this.$confirm("确定放弃本次任务发布吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$router.push("/home")}).catch(function(){})},showInput:function(){this.inputVisible=!0},handleInputConfirm:function(){this.inputVisible=!1,this.inputValue=O()(this.inputValue),""!==this.inputValue&&this.task.topics.push(this.inputValue),this.inputValue=""},handleOptionConfirm:function(){this.optionValue=O()(this.optionValue),""!==this.optionValue&&this.task.options.push(this.optionValue),this.optionValue=""},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},handleClose:function(t){this.task.topics.splice(this.task.topics.indexOf(t),1)}}},G={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"publish"},[s("div",{staticClass:"article"},[s("div",{staticClass:"title"},[t._v("发布标注任务")]),t._v(" "),s("el-form",{ref:"taskForm",attrs:{"label-width":"110px","label-position":"left",size:"medium"},model:{value:t.task,callback:function(e){t.task=e},expression:"task"}},[s("el-form-item",{attrs:{label:"任务名称",prop:"title"}},[s("el-input",{attrs:{placeholder:"任务名称"},model:{value:t.task.title,callback:function(e){t.$set(t.task,"title",e)},expression:"task.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"任务描述"}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"任务描述"},model:{value:t.task.description,callback:function(e){t.$set(t.task,"description",e)},expression:"task.description"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"图片主题"}},[s("el-select",{attrs:{multiple:""},model:{value:t.task.topics,callback:function(e){t.$set(t.task,"topics",e)},expression:"task.topics"}},t._l(t.topics,function(t){return s("el-option",{key:t.value,attrs:{label:t.value,value:t.value}})}))],1),t._v(" "),s("el-form-item",{attrs:{label:"截止时间"}},[s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd hh:mm","value-format":"yyyy-MM-dd hh:mm",placeholder:"选择截止时间","picker-options":t.endDateOpt},model:{value:t.task.endDate,callback:function(e){t.$set(t.task,"endDate",e)},expression:"task.endDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"标注类型",prop:"taskType"}},[s("el-radio-group",{model:{value:t.task.taskType,callback:function(e){t.$set(t.task,"taskType",e)},expression:"task.taskType"}},[s("el-radio",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:0}},[t._v("分类标注")]),t._v(" "),s("el-radio",{attrs:{label:1}},[t._v("标框标注")]),t._v(" "),s("el-radio",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:2}},[t._v("区域标注")])],1)],1),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===t.task.taskType,expression:"task.taskType === 0"}],attrs:{label:"分类标注标签",prop:"labels"}},[s("el-form",{staticClass:"label-form",attrs:{size:"small"},model:{value:t.task.labels,callback:function(e){t.$set(t.task,"labels",e)},expression:"task.labels"}},[t._l(t.task.labels,function(e,a){return s("el-form-item",{key:a,attrs:{label:"标签"+(a+1)}},[s("el-input",{model:{value:t.task.labels[a],callback:function(e){t.$set(t.task.labels,a,e)},expression:"task.labels[index]"}}),t._v(" "),s("el-button",{staticClass:"delete-btn",attrs:{type:"danger"},on:{click:function(e){t.deleteLabel(a)}}},[t._v("删除")])],1)}),t._v(" "),s("el-button",{attrs:{plain:""},on:{click:t.addLabel}},[t._v("添加标签")])],2)],1),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.task.taskType,expression:"task.taskType === 1"}],attrs:{label:"候选标签",size:"small"},model:{value:t.task.options,callback:function(e){t.$set(t.task,"options",e)},expression:"task.options"}},[t._l(t.task.options,function(e,a){return t.task.options.length>0?s("el-tag",{key:a,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){t.handleOptionClose(a)}}},[t._v("\n          "+t._s(e)+"\n        ")]):t._e()}),t._v(" "),s("el-input",{staticClass:"input-new-tag",attrs:{size:"small"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleOptionConfirm(e):null}},model:{value:t.optionValue,callback:function(e){t.optionValue=e},expression:"optionValue"}}),t._v(" "),s("el-button",{attrs:{size:"small",plain:""},on:{click:t.handleOptionConfirm}},[t._v("添加")])],2),t._v(" "),s("el-form-item",{attrs:{label:"上传图片",prop:"images"}},[s("el-upload",{ref:"uploadFile",attrs:{drag:"",action:"/upload/task",data:t.uploadData,"auto-upload":!1,multiple:"","on-change":t.addImage,"before-upload":t.checkPrice,"before-remove":t.removeImage,accept:"application/x-zip-compressed,image/jpg,image/png","file-list":t.filelist}},[s("i",{staticClass:"el-icon-upload"}),t._v(" "),s("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),s("em",[t._v("点击上传")])]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg、png和zip文件，且不超过20Mb")])])],1),t._v(" "),s("el-form-item",{staticClass:"num-per-pic",attrs:{label:"标注人数/图"}},[s("el-input-number",{attrs:{min:1},model:{value:t.task.numPerPic,callback:function(e){t.$set(t.task,"numPerPic",e)},expression:"task.numPerPic"}})],1),t._v(" "),s("el-form-item",{staticClass:"price",attrs:{label:"任务单价/图"}},[s("el-input-number",{attrs:{min:t.task.numPerPic},model:{value:t.task.price,callback:function(e){t.$set(t.task,"price",e)},expression:"task.price"}}),t._v(" "),s("span",[t._v("一张图最少1T币哦！")])],1)],1),t._v(" "),s("div",{staticClass:"btn-group"},[s("el-button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:t.publish}},[t._v("发布")]),t._v(" "),s("el-button",{staticClass:"cancel-btn",attrs:{type:"plain"},on:{click:t.cancel}},[t._v("取消")])],1)],1)])},staticRenderFns:[]};var Z=s("VU/8")(Q,G,!1,function(t){s("4Uxh")},null,null).exports,J={name:"topic",props:{text:{type:String}}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"topic"},[e("div",[this._v(this._s(this.text))])])},staticRenderFns:[]};var tt=s("VU/8")(J,K,!1,function(t){s("nc7f")},null,null).exports,et={name:"star",props:{size:{type:Number,default:48},score:{type:Number,default:5}},computed:{itemClasses:function(){for(var t=[],e=Math.floor(2*this.score)/2,s=0;s<e;s++)t.push("on");for(e%1!=0&&t.push("half");t.length<5;)t.push("off");return t}}},st={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"star",class:"star-"+this.size},this._l(this.itemClasses,function(t){return e("span",{key:t.id,staticClass:"star-item",class:t})}))},staticRenderFns:[]};var at=s("VU/8")(et,st,!1,function(t){s("Tmu6")},null,null).exports,it={components:{Topic:tt,Star:at},props:{keyword:{type:String}},name:"tasks",watch:{sortBy:function(){this.isSec=!0,this.getTaskInfos(1)},isSec:function(){this.getTaskInfos(1)}},data:function(){return{secCount:0,page:1,sortBy:"全部",isSec:!0,totalItemNum:0,taskInfos:[],topics:[],fullscreenLoading:!1,claList:["动物","植物","车辆","船舶","运动","美食","IT","机械","医学","人类"]}},mounted:function(){this.getTaskInfos(1)},methods:{chooseTopic:function(t){this.getTaskInfos(1)},enterTask:function(t){var e=this.taskInfos[t];localStorage.setItem("taskInfo",y()(e)),localStorage.setItem("taskState","new"),this.$router.push("/task-detail")},taskType:function(t){return["分类","标框","区域"][t]},changeSec:function(){this.secCount%2==0&&(this.isSec=!this.isSec),this.secCount++},changePage:function(t){this.page=t,this.getTaskInfos(t)},getTaskInfos:function(t){var e=this;this.fullscreenLoading=!0,this.$ajax.get("/user/tasks/search",{params:{userId:Number(this.$store.getters.id),keyword:this.keyword,sortBy:this.sortBy,isSec:this.isSec,size:9,page:t,topics:this.topics.join(",")}}).then(function(s){e.page=t;var a=(s=s.data).data;e.taskInfos=a.data,e.totalItemNum=a.totalItemNum,e.scrollTop()}).catch(function(){e.$message.error("查询失败")}).finally(function(){setTimeout(function(){e.fullscreenLoading=!1},500)})},scrollTop:function(){var t=setInterval(function(){var e=document.documentElement.scrollTop||document.body.scrollTop;(e-=10)>0?window.scrollTo(0,e):(window.scrollTo(0,0),clearInterval(t),t=null)},1)}}},nt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"tasks"},[s("div",{attrs:{id:"head"}}),t._v(" "),s("div",{staticClass:"task-wrapper"},[s("div",{staticClass:"task-head",staticStyle:{height:"120px"}},[s("h1",{staticClass:"title",staticStyle:{float:"left"}},[t._v("任务列表")]),t._v(" "),s("div",{staticClass:"seq-filter",staticStyle:{float:"right"}},[s("el-radio-group",{attrs:{size:"medium"},model:{value:t.sortBy,callback:function(e){t.sortBy=e},expression:"sortBy"}},[s("el-radio-button",{attrs:{label:"全部"}},[t._v("全部")]),t._v(" "),s("el-radio-button",{attrs:{label:"时间"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("时间 "),"时间"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"好评率"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("好评率 "),"好评率"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"奖励"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("奖励 "),"奖励"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()]),t._v(" "),s("el-radio-button",{attrs:{label:"任务量"},nativeOn:{click:function(e){return t.changeSec(e)}}},[t._v("任务量 "),"任务量"===t.sortBy?s("i",{class:{"el-icon-caret-bottom":t.isSec,"el-icon-caret-top":!t.isSec}}):t._e()])],1)],1),t._v(" "),s("div",{staticClass:"filters",staticStyle:{"padding-top":"60px"}},[s("div",{staticClass:"cla-filter"},[s("label",[t._v("选择类别:")]),t._v(" "),s("el-checkbox-group",{staticStyle:{display:"inline-block"},model:{value:t.topics,callback:function(e){t.topics=e},expression:"topics"}},t._l(this.claList,function(e){return s("el-checkbox",{key:e,attrs:{label:e},on:{change:t.chooseTopic}})}))],1)])]),t._v(" "),s("div",{staticClass:"tasks",attrs:{id:"tasks"}},[t._l(t.taskInfos,function(e,a){return s("div",{key:a,staticClass:"task-card",on:{click:function(e){t.enterTask(a)}}},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("div",{staticClass:"image-wrapper"},[s("img",{staticClass:"image",attrs:{src:"/show/"+e.id+"/"+e.picName}})]),t._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"task-title"},[t._v(t._s(e.title))]),t._v(" "),s("star",{staticClass:"hotrank",attrs:{score:e.rating,size:24}}),t._v(" "),s("div",{staticClass:"price"},[t._v(t._s(e.price)+" T币")]),t._v(" "),s("div",{staticClass:"topics"},t._l(e.topics,function(t,e){return s("topic",{key:e,staticClass:"item",attrs:{text:t}})})),t._v(" "),s("div",{staticClass:"info-blocks"},[s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务量")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(e.picNum))]),s("span",{staticClass:"unit"},[t._v("题")])])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("类型")]),t._v(" "),s("div",{staticClass:"num"},[s("strong",[t._v(t._s(t.taskType(e.taskType)))])])])]),t._v(" "),s("div",{staticClass:"startDate"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(e.startDate)+" 发布")])],1)])],1)}),t._v(" "),t._l(3,function(t){return s("div",{key:t-3,staticClass:"task-card"},[s("div",{staticClass:"empty"})])})],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.totalItemNum,expression:"totalItemNum === 0"}]},[s("i",{staticClass:"el-icon-warning"}),t._v("\n      当前暂无可接受的任务\n    ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"page"},[s("el-pagination",{ref:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":9,"current-page":t.page,total:this.totalItemNum,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":t.changePage}})],1)])])},staticRenderFns:[]};var ot=s("VU/8")(it,nt,!1,function(t){s("peNL")},null,null).exports,rt=s("Icdr");s("Vb+l"),s("Oq2I"),s("80cc"),s("miEh");var lt={name:"user",data:function(){return{showStatistics:!0,showAllHistory:!0,days:[31,28,31,30,31,30,31,31,30,31,30,31],rechargeDialogVisible:!1,rechargeAmount:0,showUpload:!1,user:{},year:2018,showChangeAvatarBtn:!1,activeMap:{1:{1:1},2:{},3:{},4:{},5:{},6:{},7:{},8:{},9:{},10:{},11:{},12:{}},payHistory:[{createTime:1527176273e3,amount:90,orderState:"INITIAL"}],payHistoryWhole:[],taskRecords:[{userId:1,taskPublisherId:9,date:"2018-9-0",price:87,correct:9,sum:12},{userId:1,taskPublisherId:9,date:"2018-9-0",price:87,correct:9,sum:12}]}},computed:{dateOfMostActivity:function(){var t="",e=0;for(var s in this.activeMap)for(var a in this.activeMap[s])this.activeMap[s][a]>=e&&(t=this.year+"-"+this.padLeft(2,s)+"-"+this.padLeft(2,a),e=this.activeMap[s][a]);return t},totalActivity:function(){var t=0;for(var e in this.activeMap)for(var s in this.activeMap[e])t+=this.activeMap[e][s];return t},longestConDays:function(){var t=1,e=1,s=!0;for(var a in this.activeMap)for(var i in this.activeMap[a])s=!1,i-1>=1?this.activeMap[a][i]>0&&this.activeMap[a][i-1]>0?(e++,console.log(e)):(t=e>t?e:t,e=1):a-1>=1&&this.activeMap[a][i]>0&&this.activeMap[a-1][this.days[a-2]]>0?e++:(t=e>t?e:t,e=1);return s?0:t>e?t:e},uploadData:function(){return{id:this.user?this.user.id:0}},getLevel:function(){switch(this.user.level){case"LEVEL_ONE":return 1;case"LEVEL_TWO":return 2;case"LEVEL_THREE":return 3;case"LEVEL_FOUR":return 4;case"LEVEL_FIVE":return 5;case"LEVEL_SIX":return 6;case"LEVEL_SEVEN":return 7}},getTitle:function(){switch(this.user.level){case"LEVEL_ONE":return"塑料";case"LEVEL_TWO":return"玄铁";case"LEVEL_THREE":return"青铜";case"LEVEL_FOUR":return"白银";case"LEVEL_FIVE":return"黄金";case"LEVEL_SIX":return"铂金";case"LEVEL_SEVEN":return"钻石"}},getAvatar:function(){return this.user&&this.user.id&&"default_avatar.png"!==this.user.avatar?"/show/avatar/"+this.user.id+"/"+this.user.avatar:"/static/image/default_avatar.png"}},mounted:function(){var t=this,e=this.$store.getters.id;this.$ajax.get("/user/info/"+e).then(function(e){var s=e.data;0===s.code?t.user=s.data:t.$message.error("查看个人信息失败！")}),0===this.$store.getters.userType?(this.drawTaskTypeChart(),this.getUserActivity()):1===this.$store.getters.userType&&this.getPayHistory()},methods:f()({},Object(i.c)({setAvatar:"changeAvatar"}),{attend:function(){var t=this;this.$ajax.get("/user/"+this.user.id+"/attend").then(function(e){0===e.data.code?(t.user.points+=1,t.user.exp+=1,t.user.isAttendant=!0):t.$message.error("签到失败")}).catch(function(){t.$message.error("签到失败")})},recharge:function(){var t=this;this.$ajax.post("/alipay/orders",{userId:this.$store.getters.id,amount:this.rechargeAmount}).then(function(e){var s=e.data.orderNo;t.$ajax.get("/alipay/"+s,{params:{from:"pc",return_url:"www.baidu.com"}}).then(function(t){document.getElementById("alipay_div").innerHTML=t.data.substring(0,t.data.indexOf("<script>")),document.forms[0].submit()})})},drawTaskTypeChart:function(){var t=this,e=rt.init(this.$refs.taskTypeChart);e.setOption({title:{text:"任务话题统计",textStyle:{fontSize:20,fontWeight:700},x:"center"},legend:{show:!0,orient:"horizontal",top:40,data:["动物","人类","医学"]},tooltip:{},series:{type:"pie",radius:"60%",center:["50%","60%"],data:[{name:"动物",value:4},{name:"人类",value:5},{name:"医学",value:10}]}}),window.addEventListener("resize",function(){e.resize()}),this.$ajax.get("/statistics/taskWorker/taskType",{params:{userId:this.$store.getters.id}}).then(function(s){var a=s.data;if(0===a.code){var i=a.data,n=B()(i),o=[];o.length<=0&&(t.showStatistics=!1),n.forEach(function(t){o.push({name:t,value:i[t]})}),e.setOption({legend:{data:n},series:{data:o}})}})},toggleChangeAvatarBtn:function(){this.showChangeAvatarBtn=!this.showChangeAvatarBtn},toggleUpload:function(){this.showUpload=!this.showUpload},uploadSuccess:function(t,e,s){this.toggleUpload(),this.user.avatar=e.name,this.setAvatar(e.name)},getUserActivity:function(){var t=this;this.year=(new Date).getFullYear(),this.$ajax.get("/user/"+this.$store.getters.id+"/activity",{params:{year:this.year}}).then(function(e){var s=e.data;0===s.code&&(t.activeMap=s.data)}).catch(function(){t.$message.error("获取活跃度失败")})},getPayHistory:function(){var t=this;this.$ajax.get("/alipay/orders/"+this.$store.getters.id).then(function(e){var s=e.data;0===s.code&&(t.payHistoryWhole=s.data.reverse(),t.payHistoryWhole.length>=5?t.payHistory=t.payHistoryWhole.slice(0,4):t.payHistory=t.payHistoryWhole)}).catch(function(){t.$message.error("获取充值记录失败")})},getTaskRecord:function(){var t=this;this.$ajax.get("/user/taskRecord/"+this.$store.getters.id).then(function(e){var s=e.data;0===s.code&&(t.taskRecords=s.data)}).catch(function(){t.$message.error("获取审核结果失败")})},padLeft:function(t,e){for(e=""+e;e.length<t;)e="0"+e;return e},timestampToTime:function(t){if(null===t||void 0===t)return"";var e=new Date(t);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()+" ")+(this.padLeft(2,e.getHours())+":")+(this.padLeft(2,e.getMinutes())+":")+this.padLeft(2,e.getSeconds())},showAllPayHistory:function(){this.payHistory=this.payHistoryWhole,this.showAllHistory=!1},hideAllPayHistory:function(){this.payHistory=this.payHistoryWhole.slice(0,4),this.showAllHistory=!0}})},ct={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-view"},[s("div",{attrs:{id:"alipay_div"}}),t._v(" "),s("div",{staticClass:"user-info-wrapper"},[s("div",{staticClass:"col-left"},[s("div",{staticClass:"user-wrapper"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showUpload,expression:"!showUpload"}],staticClass:"avatar-box",staticStyle:{width:"150px",height:"150px"},on:{mouseover:t.toggleChangeAvatarBtn,mouseout:t.toggleChangeAvatarBtn}},[s("img",{staticClass:"avatar",attrs:{src:t.getAvatar,width:"150px",height:"150px"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showChangeAvatarBtn,expression:"showChangeAvatarBtn"}],staticClass:"change-avatar-btn",on:{click:t.toggleUpload}},[t._v("更换头像")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],staticClass:"change-avatar-box"},[s("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/upload/avatar",data:t.uploadData,accept:"image/*","show-file-list":!1,"on-success":t.uploadSuccess}},[s("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("图片大小不超过2Mb")])])],1),t._v(" "),s("div",{staticClass:"userinfo-box"},[s("div",{staticClass:"username"},[t._v(t._s(t.user.username)),s("span",{staticClass:"level"},[t._v("Lv."+t._s(t.getLevel))])]),t._v(" "),s("div",{staticClass:"exp info-line"},[t._v("经验值: "+t._s(t.user.exp))]),t._v(" "),s("div",{staticClass:"title info-line"},[t._v("称号: "+t._s(t.getTitle))]),t._v(" "),s("div",{staticClass:"phone info-line"},[t._v("手机: "+t._s(t.user.phone))]),t._v(" "),s("div",{staticClass:"email info-line"},[t._v("邮箱: "+t._s(t.user.email))])])])]),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"reward-wrapper"},[s("label",[t._v("我的积分")]),t._v(" "),s("div",{staticClass:"reward-num"},[t._v("\n          "+t._s(t.user.points)+"\n        ")]),t._v(" "),t.user.isAttendant||0!==t.user.userType?t._e():s("div",{staticClass:"attend"},[s("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:t.attend}},[t._v("签到\n          ")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.user.isAttendant,expression:"user.isAttendant"}],staticClass:"attend-tip"},[t._v("今天已经签到过啦")])],1),t._v(" "),1===t.user.userType?s("div",{staticClass:"recharge"},[1===t.user.userType?s("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(e){t.rechargeDialogVisible=!0}}},[t._v("充值\n          ")]):t._e(),t._v(" "),s("el-dialog",{attrs:{title:"充值积分",visible:t.rechargeDialogVisible,width:"35%",top:"25vh"},on:{"update:visible":function(e){t.rechargeDialogVisible=e}}},[s("el-form",[s("el-form-item",{attrs:{label:"充值额度"}},[s("div",[s("el-input",{attrs:{placeholder:"请输入充值的额度(1RMB = 10积分)"},model:{value:t.rechargeAmount,callback:function(e){t.rechargeAmount=e},expression:"rechargeAmount"}},[s("span",{attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1)])],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.rechargeDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.recharge}},[t._v("确 定")])],1)],1)],1):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.user.userType,expression:"user.userType === 0"}],staticClass:"counts-wrapper"},[s("label",[t._v("我的评价")]),t._v(" "),s("div",{staticClass:"task-counts"},[s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.punctualityRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("准时率")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.accuracyRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("正确率")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s((100*t.user.satisfactionRate).toFixed(1))+"%")]),t._v(" "),s("div",{staticClass:"label"},[t._v("满意度")])])])])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===this.$store.getters.userType&&t.showStatistics,expression:"this.$store.getters.userType === 0 && showStatistics"}],staticClass:"wrapper user-statistics-wrapper"},[s("div",{ref:"taskTypeChart",staticStyle:{width:"50%",height:"330px"}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===this.$store.getters.userType,expression:"this.$store.getters.userType === 0"}],staticClass:"for-worker"},[s("div",{staticClass:"wrapper user-activity-wrapper"},[s("div",{staticStyle:{height:"170px","border-bottom":"1px solid rgba(7, 17, 27, 0.1)"}},[t._m(0),t._v(" "),s("div",{staticClass:"user-activity-content"},[t._l(12,function(e,a){return s("div",{key:a+1e3,staticStyle:{position:"absolute",top:"0","font-size":"12px",color:"#333",transform:"translateX(13px)"},style:{left:80*(e-1)+"px"}},[t._v("\n            "+t._s(t.year+"-"+t.padLeft(2,e))+"\n          ")])}),t._v(" "),t._l(t.days,function(e,a){return s("div",{key:a+100,staticStyle:{display:"inline-block"}},t._l(e,function(e,i){return s("div",{key:i,staticClass:"rect-wrapper",style:{top:i%7*14+20+"px",left:14*Math.floor(i/7)+5*a*16+"px"}},[s("el-tooltip",{attrs:{content:(t.activeMap[""+(a+1)][i+1]?t.activeMap[""+(a+1)][i+1]:"No")+" tags on "+t.year+"-"+t.padLeft(2,a+1)+"-"+t.padLeft(2,i+1),placement:"top",enterable:!1}},[s("div",{staticClass:"rect",class:{"active-4":t.activeMap[""+(a+1)][i+1]>20,"active-3":t.activeMap[""+(a+1)][i+1]>10,"active-2":t.activeMap[""+(a+1)][i+1]>5,"active-1":t.activeMap[""+(a+1)][i+1]>0}})])],1)}))})],2)]),t._v(" "),s("div",{staticClass:"user-activity-num-wrapper"},[s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s(""===t.dateOfMostActivity?"尚未进行标注":t.dateOfMostActivity))]),t._v(" "),s("div",{staticClass:"label"},[t._v("标注数目最多的一天")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s(t.totalActivity))]),t._v(" "),s("div",{staticClass:"label"},[t._v("历史总标记数")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"num"},[t._v(t._s(t.longestConDays))]),t._v(" "),s("div",{staticClass:"label"},[t._v("最长连标天数")])])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"wrapper task-history-wrapper"},[t._m(1),t._v(" "),s("div",{staticClass:"task-history-wrapper"},[s("el-table",{attrs:{data:t.taskRecords,stripe:""}},[s("el-table-column",{attrs:{prop:"date",label:"审核日期",width:"180"}}),t._v(" "),s("el-table-column",{attrs:{prop:"taskPublisherId",label:"任务id",width:"180"}}),t._v(" "),s("el-table-column",{attrs:{prop:"correct",label:"正确标注/总标注"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.correct)+"/"+t._s(e.row.sum))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"price",label:"本次任务获得积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(e.row.price)+" T币")])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini",type:"plain"}},[t._v("查看详情\n              ")])]}}])})],1)],1)])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1===this.$store.getters.userType,expression:"this.$store.getters.userType === 1"}],staticClass:"wrapper pay-history-wrapper"},[t._m(2),t._v(" "),s("div",{staticClass:"pay-history-content"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.payHistory}},[s("el-table-column",{attrs:{fixed:"",prop:"createTime",label:"创建日期"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t.timestampToTime(e.row.createTime)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"orderNo",label:"订单号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"amount",label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            ￥"),s("span",{staticStyle:{"margin-left":"8px"}},[t._v(t._s(e.row.amount))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"orderState",label:"支付状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("i",{directives:[{name:"show",rawName:"v-show",value:"PAID"===e.row.orderState,expression:"scope.row.orderState ==='PAID'"}],staticClass:"el-icon-circle-check"}),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:"PAID"!==e.row.orderState,expression:"scope.row.orderState !=='PAID'"}],staticClass:"el-icon-circle-close"}),t._v(" "),s("span",[t._v(t._s("PAID"===e.row.orderState?"已支付":"未支付"))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"payTime",label:"支付时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t.timestampToTime(e.row.payTime)))])]}}])})],1),t._v(" "),t.payHistoryWhole.length>=5?s("div",{staticClass:"show-all-btn"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showAllHistory,expression:"showAllHistory"}],on:{click:t.showAllPayHistory}},[s("i",{staticClass:"el-icon-d-arrow-right",staticStyle:{transform:"rotate(90deg)"}}),t._v("\n          展示所有充值记录\n        ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showAllHistory,expression:"!showAllHistory"}],on:{click:t.hideAllPayHistory}},[s("i",{staticClass:"el-icon-d-arrow-right",staticStyle:{transform:"rotate(-90deg)"}}),t._v("\n          收起充值记录\n        ")])]):t._e()],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header user-activity-header"},[e("i",{staticClass:"el-icon-upload"}),this._v(" 活跃度")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header task-history-header"},[e("i",{staticClass:"el-icon-document"}),this._v(" 审核结果")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pay-history-header"},[e("i",{staticClass:"iconfont"},[this._v("")]),this._v("充值记录\n    ")])}]};var ut=s("VU/8")(lt,ct,!1,function(t){s("92qD")},null,null).exports,dt={name:"task-card",components:{Topic:tt},props:{state:{type:String},taskInfo:{type:Object},inRecommend:{type:Boolean,default:!1}},data:function(){return{front:!0,showImage:!0,showRibbon:!1,showRate:!1,taskPublisherId:0,taskRecord:{taskRecordId:0,price:7,correct:8,sum:17,rank:89},open:!1}},computed:{getBanner:function(){return 0===this.taskPublisherId?"/static/image/default_banner.jpg":"/show/"+this.taskPublisherId+"/"+this.taskInfo.picName}},mounted:function(){var t=this;1===this.$store.getters.userType||"new"===this.state?this.taskPublisherId=this.taskInfo.id:this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;t.taskPublisherId=s.data.taskId,0===t.$store.getters.userType&&"PASS"===t.state&&(t.$ajax.get("/user/taskRecord",{params:{taskPublisherId:t.taskPublisherId,userId:t.$store.getters.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.showRibbon=!a.haveSeen,t.open=a.haveSeen,t.taskRecord=a}}).catch(function(){t.$message.error("获取审核奖励失败")}),t.$ajax.get("/tasks/"+t.taskPublisherId+"/worker-rank").then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=B()(a),n=i.length;t.taskRecord.rank=Math.floor(100-(i.indexOf(t.$store.getters.id+"")+1)/n*100)}}).catch(function(){t.$message.error("似乎没有网络连接")}))})},methods:{enterTask:function(){this.showRibbon||!this.front?this._rotate():(this.$ajax.get("/recommend/"+this.$store.getters.id+"/view",{params:{topics:this.taskInfo.topics.join(",")}}).then(function(t){}).catch(function(){console.log("更新查看因子失败")}),localStorage.setItem("taskInfo",y()(this.taskInfo)),localStorage.setItem("taskState",this.state),"/task-detail"===this.$route.path?(this.$router.push("/white"),this.$router.go(-1)):this.$router.push("/task-detail"))},taskType:function(t){return["分类","标框","区域"][t]},clickNotLikeBtn:function(){var t=this;this.$ajax.get("/recommend/"+this.$store.getters.id+"/not-like",{params:{topics:this.taskInfo.topics.join(",")}}).then(function(e){0===e.data.code&&(t.$emit("notlike",t.taskPublisherId),t.$message.success("反馈成功，将为您减少此类话题的任务推荐"))}).catch(function(){t.$message.error("评价失败，网络似乎出了问题")})},toggleRate:function(){this.showRate=!this.showRate},openReward:function(){var t=this;this.$ajax.get("/user/task-record/open-reward/"+this.taskRecord.taskRecordId).then(function(e){0===e.data.code?(t.open=!0,setTimeout(function(){t._rotate()},1200)):t.$message.error("似乎网络没有连接")}).catch(function(){t.$message.error("似乎网络没有连接")})},_rotate:function(){var t=this;this.open&&!this.showRibbon||(this.showRibbon=!this.showRibbon),setTimeout(function(){t.front=!t.front},500),setTimeout(function(){t.showImage=!t.showImage},800)}}},pt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-card",on:{click:t.enterTask}},[a("section",{staticClass:"container"},[a("div",{class:{flipped:!t.front},attrs:{id:"card"}},[a("figure",{staticClass:"front"},[a("transition",{attrs:{name:"drop"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showRibbon,expression:"showRibbon"}],staticClass:"ribbon"},[a("div",{staticClass:"wrap"},[a("span",[t._v("领取奖励")])])])]),t._v(" "),-1!==t.taskPublisherId?a("el-card",{staticStyle:{position:"relative"},attrs:{"body-style":{padding:"0px"}},nativeOn:{mouseenter:function(e){return t.toggleRate(e)},mouseleave:function(e){return t.toggleRate(e)}}},[a("div",{staticClass:"image-wrapper"},[a("img",{directives:[{name:"show",rawName:"v-show",value:t.showImage,expression:"showImage"}],staticClass:"image",attrs:{src:t.getBanner}})]),t._v(" "),t.inRecommend?a("transition",{attrs:{name:"slide"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showRate,expression:"showRate"}],staticClass:"rate-wrapper",on:{click:function(e){return e.stopPropagation(),t.clickNotLikeBtn(e)}}},[a("div",{staticClass:"text"},[a("i",{staticClass:"iconfont",staticStyle:{"font-size":"28px",display:"inline-block","vertical-align":"top","margin-top":"-1px"}},[t._v("")]),t._v(" "),a("span",{staticStyle:{display:"inline-block","vertical-align":"top"}},[t._v("不感兴趣")])])])]):t._e(),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"task-title"},[t._v(t._s(t.taskInfo.title))]),t._v(" "),a("el-rate",{staticClass:"hotrank",attrs:{disabled:""},model:{value:t.taskInfo.rating,callback:function(e){t.$set(t.taskInfo,"rating",e)},expression:"taskInfo.rating"}}),t._v(" "),a("div",{staticClass:"price"},[t._v(t._s(t.taskInfo.price)+" T币")]),t._v(" "),a("div",{staticClass:"topics"},t._l(t.taskInfo.topics,function(t,e){return a("topic",{key:e,staticClass:"item",attrs:{text:t}})})),t._v(" "),a("div",{staticClass:"info-blocks"},[a("div",{staticClass:"block"},[a("div",{staticClass:"label"},[t._v("任务量")]),t._v(" "),a("div",{staticClass:"num"},[a("strong",[t._v(t._s(t.taskInfo.picNum))]),a("span",{staticClass:"unit"},[t._v("题")])])]),t._v(" "),a("div",{staticClass:"block"},[a("div",{staticClass:"label"},[t._v("类型")]),t._v(" "),a("div",{staticClass:"num"},[a("strong",[t._v(t._s(t.taskType(t.taskInfo.taskType)))])])])]),t._v(" "),a("div",{staticClass:"startDate"},[a("i",{staticClass:"iconfont"},[t._v("")]),t._v(" "+t._s(t.taskInfo.startDate)+" 发布")])],1)],1):t._e()],1),t._v(" "),a("figure",{staticClass:"back"},[a("div",{staticClass:"reward-wrapper",staticStyle:{padding:"0 20px","background-image":"linear-gradient(to top, #e6e9f0 0%, #f8fbff 100%)"}},[a("img",{staticStyle:{display:"inline-block"},attrs:{src:s("9cIw"),width:"55",height:"55"}}),t._v(" "),t._m(0),t._v(" "),a("div",{staticStyle:{color:"#409eff","font-size":"24px","margin-bottom":"30px"}},[t._v("任务卡")]),t._v(" "),a("div",{staticStyle:{color:"#777"}},[t._v("本次任务收获")]),t._v(" "),a("div",{staticStyle:{margin:"20px 0",display:"flex"}},[a("div",{staticClass:"block",staticStyle:{flex:"1"}},[a("div",{staticStyle:{"font-size":"30px",color:"#409eff","margin-bottom":"8px"}},[t._v(t._s(t.taskRecord.price))]),t._v(" "),a("div",{staticStyle:{color:"#777"}},[t._v("T币")])]),t._v(" "),a("div",{staticClass:"block",staticStyle:{flex:"1"}},[a("div",{staticStyle:{"font-size":"30px",color:"#409eff","margin-bottom":"8px"}},[t._v(t._s(t.taskRecord.correct))]),t._v(" "),a("div",{staticStyle:{color:"#777"}},[t._v("经验")])]),t._v(" "),a("div",{staticClass:"block",staticStyle:{flex:"1"}},[a("div",{staticStyle:{"font-size":"30px",color:"#409eff","margin-bottom":"8px"}},[t._v(t._s(Math.floor(t.taskRecord.correct/t.taskRecord.sum*100))+"%\n              ")]),t._v(" "),a("div",{staticStyle:{color:"#777"}},[t._v("准确率")])])]),t._v(" "),a("div",{staticStyle:{"line-height":"20px",color:"#777"}},[t._v("在"),a("span",{staticStyle:{color:"#409eff"}},[t._v(" "+t._s(t.taskRecord.sum)+" ")]),t._v("个标注中标对了\n            "),a("span",{staticStyle:{color:"#409eff"}},[t._v(t._s(t.taskRecord.correct))]),t._v(" 个"),a("br"),t._v("打败了 "),a("span",{staticStyle:{color:"#409eff"}},[t._v(t._s(t.taskRecord.rank)+"%")]),t._v(" 的标注者"),a("br"),t._v("要继续努力哦！\n          ")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.open,expression:"!open"}],attrs:{round:"",id:"open-btn"},nativeOn:{click:function(e){return e.stopPropagation(),t.openReward(e)}}},[t._v("领取奖励")]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.open,expression:"open"}],staticClass:"open-text"},[t._v("领取成功，可在个人中心查看")])],1)])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{margin:"30px 0 10px 0",width:"120px",overflow:"hidden",display:"inline-block"}},[e("img",{staticStyle:{transform:"translateX(-45px) translateY(4px)"},attrs:{src:s("6PsS")}})])}]};var ht=s("VU/8")(dt,pt,!1,function(t){s("aVWu")},null,null).exports,vt={name:"pagination",props:{pageSize:{type:Number},page:{type:Number},totalItemNum:{type:Number}},methods:{changePage:function(t){this.$emit("changePage",t)}}},ft={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pagination"},[e("el-pagination",{ref:"pagination",attrs:{background:"",layout:"prev, pager, next","page-size":this.pageSize,"current-page":this.page,total:this.totalItemNum,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":this.changePage}})],1)},staticRenderFns:[]};var mt=s("VU/8")(vt,ft,!1,function(t){s("IrNe")},null,null).exports,gt={components:{Pagination:mt,TaskCard:ht},name:"my-task",data:function(){return{page:1,totalItemNum:0,state:"PROCESSING",taskInfos:[],fullscreenLoading:!1}},watch:{state:function(){var t=this;this.taskInfos=[],this.$nextTick(function(){t.getTaskInfos()})}},mounted:function(){this.getTaskInfos()},methods:{changePage:function(t){this.page=t,this.getTaskInfos()},getTaskInfos:function(){var t=this;this.fullscreenLoading=!0,1===this.$store.getters.userType?this.$ajax.get("/tasks/list",{params:{userId:this.$store.getters.id,state:this.state,size:9,page:this.page}}).then(function(e){var s=e.data.data;t.taskInfos=s.data,t.totalItemNum=s.totalItemNum}).finally(function(){setTimeout(function(){t.fullscreenLoading=!1},500)}):this.$ajax.get("/user/"+this.$store.getters.id+"/tasks",{params:{state:this.state,size:9,page:this.page}}).then(function(e){var s=e.data.data;t.taskInfos=s.data,t.totalItemNum=s.totalItemNum}).finally(function(){setTimeout(function(){t.fullscreenLoading=!1},500)})}}},kt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"my-task"},[s("el-tabs",{staticClass:"state-tab",model:{value:t.state,callback:function(e){t.state=e},expression:"state"}},[s("el-tab-pane",{attrs:{name:"PROCESSING"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-time"}),t._v(" 进行中的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"PROCESSING"===t.state,expression:"state === 'PROCESSING'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),s("el-tab-pane",{attrs:{name:"SUBMITTED"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"iconfont"},[t._v("")]),t._v(" 已提交的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"SUBMITTED"===t.state,expression:"state === 'SUBMITTED'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),0===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"PASS"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-check"}),t._v(" 通过的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"PASS"===t.state,expression:"state === 'PASS'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),1===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"DONE"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-check"}),t._v(" 已完成的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"DONE"===t.state,expression:"state === 'DONE'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),0===this.$store.getters.userType?s("el-tab-pane",{attrs:{name:"REJECT"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-close"}),t._v(" 失败的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"REJECT"===t.state,expression:"state === 'REJECT'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]):t._e(),t._v(" "),s("el-tab-pane",{attrs:{name:"OVERTIME"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-circle-close"}),t._v(" 超时的任务"),s("span",{directives:[{name:"show",rawName:"v-show",value:"OVERTIME"===t.state,expression:"state === 'OVERTIME'"}]},[t._v(" ("+t._s(t.taskInfos.length)+")")])])]),t._v(" "),s("div",{staticClass:"task-out-wrapper"},[s("div",{staticClass:"task-wrapper"},[s("div",{staticClass:"tasks"},[t._l(t.taskInfos,function(e,a){return s("div",{key:a,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":e,state:t.state}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e-20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])})],2)])])],1),t._v(" "),0===t.totalItemNum?s("div",[s("i",{staticClass:"el-icon-warning"}),t._v("没有在该状态的任务")]):t._e(),t._v(" "),t.totalItemNum>0?s("pagination",{attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:9},on:{changePage:t.changePage}}):t._e()],1)},staticRenderFns:[]};var _t=s("VU/8")(gt,kt,!1,function(t){s("lWb7")},null,null).exports,yt=s("Icdr");s("GbHy"),s("rjsW"),s("miEh");var bt={name:"task-detail",components:{TaskCard:ht,Star:at},data:function(){return{state:"",rateValue:0,rateOnlyRead:!1,progress:0,fromPath:"/",taskInfo:{id:0,title:"",taskType:0,startDate:"",endDate:"",price:0},similarTasks:[]}},beforeRouteEnter:function(t,e,s){s(function(t){return t.setFrom(e.path)})},methods:{setFrom:function(t){this.fromPath=t},taskType:function(t){return["分类","标框","区域"][t]},acceptTask:function(){var t=this;this.$ajax.get("/user/new/"+this.taskInfo.id,{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data;localStorage.setItem("taskWorker",y()(a)),localStorage.setItem("boardState","edit"),t.$router.push("/board")}else t.$message.error("接受任务失败")}).catch(function(){t.$message.error("接受任务失败")})},continueTask:function(){var t=this;localStorage.setItem("boardState","edit"),this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;localStorage.setItem("taskWorker",y()(a)),localStorage.setItem("boardState","edit"),t.$router.push("/board")}else t.$message.error("接受任务失败")}).catch(function(){t.$message.error("接受任务失败")})},viewResult:function(){var t=this;this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.$ajax.get("/user/taskworker-detail/"+t.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var i=s.data;i.forEach(function(t){for(var e=function(e){if(a.images[e].filename===t.filename)return a.images[e].tags=[],t.correct.forEach(function(t){t.color="green",a.images[e].tags.push(t)}),t.wrong.forEach(function(t){t.color="red",a.images[e].tags.push(t)}),t.miss.forEach(function(t){t.color="blue",a.images[e].tags.push(t)}),"break"},s=0;s<a.images.length;s++){if("break"===e(s))break}}),console.log(a),console.log(i),localStorage.setItem("taskWorker",y()(a)),localStorage.setItem("boardState","view-result"),t.$router.push("/board")}}).catch(function(){})}}).catch(function(){})},rate:function(){var t=this;this.rateOnlyRead=!0,this.$ajax.post("/user/rating",this.$qs.stringify({taskWorkerId:this.taskInfo.id,rating:this.rateValue})).then(function(e){0===e.data.code?t.$message.success("感谢您的评价！"):t.$message.error("评价失败")}).catch(function(){t.$message.error("评价失败")})},drawRateChart:function(){var t=yt.init(this.$refs.rateChart);t.setOption({title:{text:"任务评价统计",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){var s=e[0].name,a=0;t.getOption().series[0].data.forEach(function(t){a+=t});for(var i=0,n=e.length;i<n;i++)s+="<br/>"+e[i].value+"人("+(e[i].value/a*100).toFixed(2)+"%)";return s}},legend:{data:["5星","4星","3星","2星","1星"].reverse()},grid:{left:"3%",right:"15%",bottom:"3%",containLabel:!0},xAxis:[{name:"人数(人)",type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:["5星","4星","3星","2星","1星"].reverse()}],series:[{data:[200,22,35,10,90].reverse(),type:"bar",itemStyle:{normal:{color:function(t){return["#FF8607","#FF9900","#ffc001","#F7BA2A","#99A9BF"].reverse()[t.dataIndex]},label:{show:!0,position:"right"}}}}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/rating",{params:{taskPublisherId:this.taskInfo.id}}).then(function(e){var s=e.data;if(0===s.code){for(var a=s.data,i=[],n=1;n<=5;n++)i.push(a[n]);t.setOption({series:[{data:i}]})}})},drawWorkerChart:function(){var t=yt.init(this.$refs.workerChart);t.setOption({title:{text:"工人质量分析",x:"center"},tooltip:{formatter:function(t){var e=t.value;return"工人平均质量<br>\n            等级：Lv."+e[0]+"<br>\n            经验："+e[1]+"<br>\n            积分："+e[2]+"<br>\n            准确率："+e[3]+"%<br>\n            准时率："+e[4]+"%"}},radar:[{indicator:[{text:"等级",max:7},{text:"经验",max:8e3},{text:"积分",max:8e3},{text:"准确率",max:100},{text:"准时率",max:100}],radius:100,center:["50%","60%"]}],series:[{type:"radar",tooltip:{trigger:"item"},itemStyle:{normal:{areaStyle:{type:"default"}}},data:[{value:[4,800,23,78,100]}]}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/workerInfo",{params:{taskPublisherId:this.taskInfo.id}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.setOption({radar:{indicator:[{text:"等级",max:7},{text:"经验",max:a.exp<500?500:1.2*a.exp},{text:"积分",max:a.point<500?500:1.2*a.point},{text:"准确率",max:100},{text:"准时率",max:100}]},series:[{data:[{value:[a.level,a.exp,a.point,a.accuracyRate,a.punctualityRate]}]}]})}})},drawProgress:function(){var t=this,e="",s={};1===this.$store.getters.userType?(e="/statistics/taskPublisher/progress",s={taskPublisherId:this.taskInfo.id}):0===this.$store.getters.userType&&(e="/statistics/taskWorker/progress",s={taskWorkerId:this.taskInfo.id}),this.$ajax.get(e,{params:s}).then(function(e){var s=e.data;0===s.code&&(t.progress=(100*s.data).toFixed(0))})}},mounted:function(){var t=this,e=localStorage.getItem("taskInfo"),s=localStorage.getItem("taskState");e&&(this.taskInfo=JSON.parse(e),this.state=s),1===this.$store.getters.userType?(this.drawProgress(),this.drawRateChart(),this.drawWorkerChart()):0===this.$store.getters.userType&&("PROCESSING"===this.state&&this.drawProgress(),"SUBMITTED"!==this.state&&"PASS"!==this.state||this.$ajax.get("/user/"+this.taskInfo.id).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.rateValue=a.rating,0!==t.rateValue&&(t.rateOnlyRead=!0)}}),this.$ajax.get("/recommend/item",{params:{taskPublisherId:this.taskInfo.id,userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code&&(t.similarTasks=s.data),window.scrollTo(0,0)}).catch(function(){t.$message.error("获取相似任务失败")}))}},wt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-detail"},[s("el-row",{staticClass:"task-detail-row",attrs:{gutter:30}},[s("div",{staticClass:"breadcrumb-nav"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},["/tasks"===t.fromPath?s("el-breadcrumb-item",{attrs:{to:{path:"/tasks"}}},[t._v("任务中心")]):t._e(),t._v(" "),"/myTasks"===t.fromPath?s("el-breadcrumb-item",{attrs:{to:{path:"/myTasks"}}},[t._v("我的任务")]):t._e(),t._v(" "),s("el-breadcrumb-item",[t._v("任务详情")])],1)],1),t._v(" "),s("el-col",{attrs:{span:15}},[s("el-card",{staticClass:"col-left-card"},[s("div",{staticClass:"task-label-wrapper"},[s("div",[s("h1",{staticClass:"title"},[t._v(t._s(t.taskInfo.title))]),t._v(" "),s("div",{staticClass:"topic-wrapper"},t._l(t.taskInfo.topics,function(e,a){return s("el-tag",{key:a,staticClass:"topics"},[t._v(t._s(e))])}))]),t._v(" "),s("div",{staticClass:"col-left"},[s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-document"}),t._v("任务类型: ")]),t._v(" "),s("span",{staticClass:"task-type"},[t._v(t._s(t.taskType(t.taskInfo.taskType))+"标注")])]),t._v(" "),s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-time"}),t._v("发布时间: ")]),t._v(" "),s("span",{staticClass:"start-date"},[t._v(t._s(t.taskInfo.startDate))])])]),t._v(" "),s("div",{staticClass:"col-right"},[s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-star-off"}),t._v("任务评价: ")]),t._v(" "),s("star",{staticClass:"hotrank",attrs:{score:t.taskInfo.rating,size:24}})],1),t._v(" "),s("div",{staticClass:"line"},[s("span",{staticClass:"label"},[s("i",{staticClass:"el-icon-date"}),t._v("结束时间: ")]),t._v(" "),s("span",[t._v(t._s(t.taskInfo.endDate))])])])]),t._v(" "),s("div",{staticClass:"task-desc-wrapper"},[s("span",{staticClass:"header"},[t._v("任务描述")]),t._v(" "),s("p",{staticClass:"task-desc"},[t._v(t._s(t.taskInfo.description))])])])],1),t._v(" "),s("el-col",{attrs:{span:9}},[s("el-card",{staticClass:"reward-box"},[s("div",{staticClass:"num-box"},[s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务奖励")]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.taskInfo.price)+" T币")])]),t._v(" "),s("div",{staticClass:"block"},[s("div",{staticClass:"label"},[t._v("任务题量")]),t._v(" "),s("div",{staticClass:"text"},[t._v(t._s(t.taskInfo.picNum)+" 图")])])]),t._v(" "),0===this.$store.getters.userType?s("div",{staticClass:"worker-btn"},["PROCESSING"===t.state?s("el-button",{attrs:{round:"",type:"danger"},on:{click:t.continueTask}},[t._v("继续任务")]):t._e(),t._v(" "),"new"===t.state?s("el-button",{attrs:{round:"",type:"danger"},on:{click:t.acceptTask}},[t._v("开始任务")]):t._e(),t._v(" "),"PASS"===t.state?s("el-button",{attrs:{round:"",type:"danger"},on:{click:t.viewResult}},[t._v("查看审核结果")]):t._e()],1):t._e(),t._v(" "),1===this.$store.getters.userType?s("div",{staticClass:"publisher-btn",staticStyle:{width:"100%"}},["DONE"===t.state||"OVERTIME"===t.state?s("el-button",{staticClass:"download-btn",attrs:{round:"",type:"plain"}},[s("a",{attrs:{href:"/download/tag-data/"+t.taskInfo.id}},[s("i",{staticClass:"el-icon-download",staticStyle:{display:"inline-block","vertical-align":"top","font-size":"16px"}}),s("span",{staticStyle:{display:"inline-block","vertical-align":"top","font-size":"15px"}},[t._v("下载标注数据")])])]):t._e()],1):t._e()]),t._v(" "),"PROCESSING"===this.state?s("el-card",{staticClass:"progress-card"},[s("h1",{staticClass:"header"},[t._v("任务进度")]),t._v(" "),s("el-progress",{attrs:{percentage:t.progress}})],1):t._e(),t._v(" "),0===this.$store.getters.userType&&"SUBMITTED"===t.state||"PASS"===t.state?s("el-card",{staticClass:"rate-card"},[s("h1",{staticClass:"header"},[t._v("我的评价")]),t._v(" "),s("el-rate",{attrs:{disabled:t.rateOnlyRead,colors:["#99A9BF","#F7BA2A","#FF9900"],"text-color":"#ff9900","show-score":!0},on:{change:t.rate},model:{value:t.rateValue,callback:function(e){t.rateValue=e},expression:"rateValue"}})],1):t._e()],1)],1),t._v(" "),1===this.$store.getters.userType?s("el-row",{staticClass:"task-statistic-row"},[s("el-card",{staticClass:"taskpub-rate-card"},[s("h1",{staticClass:"header"},[t._v("任务分析")]),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("div",{ref:"rateChart",staticStyle:{width:"100%",height:"300px"}})]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",{ref:"workerChart",staticStyle:{width:"100%",height:"300px"}})])],1)],1)],1):t._e(),t._v(" "),"new"===this.state?s("div",{staticClass:"itemRE"},[s("div",{staticClass:"title"},[t._v("\n      相似推荐\n    ")]),t._v(" "),s("div",{staticClass:"similar-task-wrapper"},[t._l(t.similarTasks,function(t,e){return s("div",{key:e,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":t,state:"new","in-recommend":!0}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e+20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])})],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.similarTasks.length,expression:"similarTasks.length === 0"}],staticClass:"no-similar-task"},[t._v("没有相似的任务")])]):t._e()],1)},staticRenderFns:[]};var xt=s("VU/8")(bt,wt,!1,function(t){s("rAI6")},null,null).exports,Ct=s("Jpv8"),Tt={name:"rank",components:{AwardIcon:Ct.a,StopCircleIcon:Ct.d,CheckIcon:Ct.c,ThumbsUpIcon:Ct.e,BoxIcon:Ct.b},data:function(){return{workerRankType:"积分",workerOptions:["积分","经验","准确度"],publisherRankType:"积分",publisherOptions:["积分","经验","任务数"],workerRank:[],publisherRank:[]}},watch:{workerRankType:function(){switch(this.workerRankType){case"积分":this.getRank("worker","Point");break;case"经验":this.getRank("worker","Exp");break;case"准确度":this.getRank("worker","AccuracyRate")}},publisherRankType:function(){switch(this.publisherRankType){case"积分":this.getRank("pub","Point");break;case"经验":this.getRank("pub","Exp");break;case"任务数":this.getRank("pub","Task")}}},methods:{getAvatar:function(t,e){return t&&"default_avatar.png"!==e?"/show/avatar/"+t+"/"+e:"/static/image/default_avatar.png"},getRank:function(t,e){var s=this,a=0;("worker"===t&&0===this.$store.getters.userType||"pub"===t&&1===this.$store.getters.userType)&&(a=this.$store.getters.id),this.$ajax.get("/rank/"+t+e,{params:{userId:a}}).then(function(e){var a=e.data;"worker"===t?s.workerRank=a.data.rankList:"pub"===t&&(s.publisherRank=a.data.rankList)})}},mounted:function(){this.getRank("worker","Point"),this.getRank("pub","Point")}},St={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rank"},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"rank-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"title"},[t._v("众包工人排行榜")]),t._v(" "),s("el-select",{staticClass:"rank-type-select",staticStyle:{float:"right"},attrs:{size:"small",placeholder:"请选择"},model:{value:t.workerRankType,callback:function(e){t.workerRankType=e},expression:"workerRankType"}},t._l(t.workerOptions,function(t){return s("el-option",{key:t.value,attrs:{value:t}})}))],1),t._v(" "),s("el-table",{staticClass:"rank-table",staticStyle:{width:"100%"},attrs:{data:t.workerRank,fit:""}},[s("el-table-column",{attrs:{type:"index"}}),t._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户",width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("img",{staticClass:"avatar",attrs:{width:"30px",height:"30px",src:t.getAvatar(e.row.id,e.row.avatar)}}),t._v(" "),s("span",{staticClass:"username"},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"points",label:"积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("stop-circle-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.points))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"exp",label:"经验"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("award-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.exp))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"accuracyRate",label:"准确度"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("check-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s((100*e.row.accuracyRate).toFixed(1))+"%")])]}}])})],1)],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-card",{staticClass:"rank-card"},[s("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"title"},[t._v("众包发起者排行榜")]),t._v(" "),s("el-select",{staticClass:"rank-type-select",staticStyle:{float:"right"},attrs:{size:"small",placeholder:"请选择"},model:{value:t.publisherRankType,callback:function(e){t.publisherRankType=e},expression:"publisherRankType"}},t._l(t.publisherOptions,function(t){return s("el-option",{key:t.value,attrs:{value:t}})}))],1),t._v(" "),s("el-table",{staticClass:"rank-table",staticStyle:{width:"100%"},attrs:{data:t.publisherRank}},[s("el-table-column",{attrs:{type:"index"}}),t._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户",width:"145"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("img",{staticClass:"avatar",attrs:{width:"30px",height:"30px",src:t.getAvatar(e.row.id,e.row.avatar)}}),t._v(" "),s("span",{staticClass:"username"},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"points",label:"积分"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("stop-circle-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.points))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"exp",label:"经验"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("award-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.exp))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"taskNum",label:"任务数"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("box-icon",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"num"},[t._v(t._s(e.row.taskNum))])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]};var It=s("VU/8")(Tt,St,!1,function(t){s("74p7")},null,null).exports,Pt={name:"admin",mounted:function(){"/board"===localStorage.getItem("fromRoute")?(this.$refs.menu.activeIndex="check-tag",this.$router.push("/check-tag"),localStorage.setItem("fromRoute","")):this.$router.push("/system-state")}},$t={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"admin"},[e("div",{staticClass:"left"},[e("el-menu",{ref:"menu",staticClass:"menu",attrs:{router:!0,"default-active":"system-state","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[e("el-menu-item",{attrs:{index:"system-state"}},[e("i",{staticClass:"el-icon-location"}),this._v(" "),e("span",[this._v("查看系统状态")])]),this._v(" "),e("el-menu-item",{attrs:{index:"check-task"}},[e("i",{staticClass:"el-icon-document"}),this._v(" "),e("span",{attrs:{slot:"title"},slot:"title"},[this._v("审核发起的任务")])])],1)],1),this._v(" "),e("div",{staticClass:"right"},[e("router-view")],1)])},staticRenderFns:[]};var Et=s("VU/8")(Pt,$t,!1,function(t){s("Dg3x")},null,null).exports,Nt={name:"check-task",components:{Pagination:mt},data:function(){return{task:{title:"",picNum:"",taskType:1,price:0,description:"",startDate:"",endDate:"",topics:[]},page:1,pageSize:8,totalItemNum:0,taskList:[],images:[],checkTaskdialogVisible:!1}},mounted:function(){this.getSubmittedTasks()},watch:{page:function(){this.getSubmittedTasks()}},methods:{taskType:function(t){return["分类","标框","区域"][t]+"标注"},showDialog:function(t){var e=this;this.checkTaskdialogVisible=!0,this.task=this.taskList[t],this.$ajax.get("/tasks/"+this.task.id).then(function(t){var s=t.data;0===s.code&&(e.images=s.data.images)})},deleteTask:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id===t){this.taskList.splice(e,1),this.totalItemNum--;break}},check:function(t){var e=this;this.$ajax.post("/admin/checkTask/"+this.task.id,this.$qs.stringify({checkResult:t})).then(function(t){0===t.data.code?(e.$message.success("审核成功"),e.deleteTask(e.task.id)):e.$message.error("审核失败")}).catch(function(){e.$message.error("审核失败")}),this.checkTaskdialogVisible=!1},changePage:function(t){this.page=t},getSubmittedTasks:function(){var t=this;this.$ajax.get("/tasks/list",{params:{userId:0,state:"SUBMITTED",size:this.pageSize,page:this.page}}).then(function(e){var s=e.data.data;t.taskList=s.data,t.totalItemNum=s.totalItemNum})}}},Rt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"check-task"},[s("el-card",{staticClass:"submitted-tasks"},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("待审核的发起任务")])]),t._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.taskList,"max-height":"510"}},[s("el-table-column",{attrs:{label:"ID",prop:"id"}}),t._v(" "),s("el-table-column",{attrs:{label:"标题",prop:"title",width:"180"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务量",prop:"picNum"}}),t._v(" "),s("el-table-column",{attrs:{label:"价格",prop:"price"}}),t._v(" "),s("el-table-column",{attrs:{label:"发布时间",prop:"startDate",width:"150px"}}),t._v(" "),s("el-table-column",{attrs:{label:"结束时间",prop:"endDate",width:"150px"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){t.showDialog(e.$index)}}},[t._v("审核\n          ")])]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:"审核任务",visible:t.checkTaskdialogVisible,width:"50%",top:"60px"},on:{"update:visible":function(e){t.checkTaskdialogVisible=e}}},[t.totalItemNum>0?s("div",{staticClass:"detail-wrapper"},[s("el-row",[s("el-col",{attrs:{span:12}},[s("div",[s("label",[t._v("任务名称")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.title))])]),t._v(" "),s("div",[s("label",[t._v("开始日期")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.startDate))])]),t._v(" "),s("div",[s("label",[t._v("图片数量")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.picNum)+"张")])])]),t._v(" "),s("el-col",{attrs:{span:12}},[s("div",[s("label",[t._v("任务类型")]),s("span",{staticClass:"text"},[t._v(t._s(t.taskType(t.task.taskType)))])]),t._v(" "),s("div",[s("label",[t._v("结束日期")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.endDate))])]),t._v(" "),s("div",[s("label",[t._v("任务奖励")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.price)+"T币")])])])],1),t._v(" "),s("el-row",[s("div",[s("label",[t._v("任务话题")]),t._v(" "),t._l(t.task.topics,function(e){return s("div",{key:e,staticClass:"topic-wrapper"},[s("el-tag",{attrs:{size:"mini"}},[t._v(t._s(e))])],1)})],2),t._v(" "),s("div",[s("label",[t._v("任务描述")]),s("span",{staticClass:"text"},[t._v(t._s(t.task.description))])])]),t._v(" "),s("el-row",[s("el-carousel",t._l(t.images.length,function(e,a){return s("el-carousel-item",{key:e},[s("img",{attrs:{src:"/show/"+t.task.id+"/"+t.images[a],width:"100%"}})])}))],1)],1):t._e(),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"medium"},on:{click:function(e){t.check(!0)}}},[t._v("通 过")]),t._v(" "),s("el-button",{attrs:{type:"danger",size:"medium"},on:{click:function(e){t.check(!1)}}},[t._v("不 通 过")])],1)])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"pagination-wrapper"},[s("pagination",{staticClass:"my-pagination",attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:t.pageSize},on:{changePage:t.changePage}})],1)],1)},staticRenderFns:[]};var At=s("VU/8")(Nt,Rt,!1,function(t){s("Raw4")},null,null).exports,Lt={name:"check-tag",components:{Pagination:mt},data:function(){return{page:1,totalItemNum:0,pageSize:9,taskList:[],chosenTask:[]}},mounted:function(){this.getSubmittedTasks()},watch:{page:function(){this.getSubmittedTasks()}},methods:{showTagDetailDialog:function(t){var e=this;this.index=t,this.$ajax.get("/user/"+this.taskList[t].id).then(function(t){var s=t.data;0===s.code&&(localStorage.setItem("taskWorker",y()(s.data)),localStorage.setItem("boardState","check"),e.$router.push("/board"))})},changePage:function(t){this.page=t},handleSelectionChange:function(t){this.chosenTask=t},getSubmittedTasks:function(){var t=this;this.$ajax.get("/user/0/tasks",{params:{size:this.pageSize,page:this.page,state:"SUBMITTED"}}).then(function(e){var s=e.data.data;t.taskList=s.data,t.totalItemNum=s.totalItemNum})},deleteTask:function(t){for(var e=0;e<this.taskList.length;e++)if(this.taskList[e].id===t){this.taskList.splice(e,1);break}this.totalItemNum--},check:function(t){for(var e=this,s=function(s){e.$ajax.post("/admin/checkTag/"+e.chosenTask[s].id,e.$qs.stringify({checkResult:t})).then(function(t){0===t.data.code?(e.$message.success("审核成功"),e.deleteTask(e.chosenTask[s].id),e.chosenTask.splice(s,1)):e.$message.error("审核失败")}).catch(function(){e.$message.error("审核失败")})},a=0;a<this.chosenTask.length;a++)s(a)}}},zt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"check-tag"},[s("el-card",[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("待审核的工人标注")]),t._v(" "),s("div",{staticClass:"check-btn-group"},[s("el-button",{attrs:{size:"mini",type:"plain"},on:{click:function(e){t.check(1)}}},[t._v("批量通过")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("批量不通过")])],1)]),t._v(" "),s("el-table",{attrs:{data:t.taskList,"max-height":"510"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{label:"工人任务ID",prop:"id"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务名称",prop:"title"}}),t._v(" "),s("el-table-column",{attrs:{label:"任务量",prop:"picNum"}}),t._v(" "),s("el-table-column",{attrs:{label:"提交时间",prop:"endDate"}}),t._v(" "),s("el-table-column",{attrs:{label:"奖励",prop:"price"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{staticClass:"detail-btn",attrs:{type:"plain",icon:"el-icon-back",circle:""},on:{click:function(s){t.showTagDetailDialog(e.$index)}}})]}}])})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.totalItemNum>0,expression:"totalItemNum > 0"}],staticClass:"pagination-wrapper"},[s("pagination",{staticClass:"my-pagination",attrs:{page:t.page,totalItemNum:t.totalItemNum,pageSize:t.pageSize},on:{changePage:t.changePage}})],1)],1)},staticRenderFns:[]};var Ut=s("VU/8")(Lt,zt,!1,function(t){s("/EJr")},null,null).exports,Dt=s("Icdr");s("Vb+l"),s("GbHy"),s("4UDB"),s("Oq2I"),s("80cc"),s("miEh");var Ft={name:"sys-state",components:{},methods:{drawUserChart:function(){var t=this,e=Dt.init(this.$refs.userChart);e.setOption({title:{text:"用户数量",x:"center"},legend:{show:!0,orient:"horizontal",bottom:0,data:["众包工人","众包发起者"]},tooltip:{trigger:"item",position:"inside",formatter:"{b} : {c} ({d}%)"},series:[{name:"用户数量",type:"pie",radius:"65%",center:["50%","50%"],data:[],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"},normal:{label:{show:!1},labelLine:{show:!1}}}}]}),window.addEventListener("resize",function(){e.resize()}),this.$ajax.get("/admin/list/worker",{params:{size:9,page:1,keyword:"",sortBy:"全部",isSec:!0}}).then(function(s){var a=s.data;if(0===a.code)var i=a.data;t.$ajax.get("/admin/list/publisher",{params:{size:9,page:1,keyword:"",sortBy:"全部",isSec:!0}}).then(function(t){var s=t.data;if(0===s.code){var a=s.data;e.setOption({series:[{data:[{value:i.totalItemNum,name:"众包工人"},{value:a.totalItemNum,name:"众包发起者"}]}]})}})})},drawTaskChart:function(){var t=Dt.init(this.$refs.taskChart);t.setOption({title:{text:"众包任务数量",x:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["审核中","进行中","已完成"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"value"}],yAxis:[{type:"category",axisTick:{show:!1},data:["审核中","进行中","已完成"]}],series:[{data:[10,22,35],type:"bar",label:{normal:{show:!0,position:"inside"}}}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/state").then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=B()(a),n=[];i.forEach(function(t){n.push(a[t])}),t.setOption({legend:{data:i},yAxis:{data:i},series:[{data:n}]})}})},drawUserGrowthChart:function(){var t=Dt.init(this.$refs.userGrowthChart),e=[["2000-06-05",116],["2000-06-06",129],["2000-06-07",135],["2000-06-08",86],["2000-06-09",73],["2000-06-10",85],["2000-06-11",73],["2000-06-12",68],["2000-06-13",92],["2000-06-14",130],["2000-06-15",245],["2000-06-16",139],["2000-06-17",115],["2000-06-18",111],["2000-06-19",309],["2000-06-20",206],["2000-06-21",137],["2000-06-22",128],["2000-06-23",85],["2000-06-24",94],["2000-06-25",71],["2000-06-26",106],["2000-06-27",84],["2000-06-28",93],["2000-06-29",85],["2000-06-30",73],["2000-07-01",83],["2000-07-02",125],["2000-07-03",107],["2000-07-04",82],["2000-07-05",44],["2000-07-06",72],["2000-07-07",106],["2000-07-08",107],["2000-07-09",66],["2000-07-10",91],["2000-07-11",92],["2000-07-12",113],["2000-07-13",107],["2000-07-14",131],["2000-07-15",111],["2000-07-16",64],["2000-07-17",69],["2000-07-18",88],["2000-07-19",77],["2000-07-20",83],["2000-07-21",111],["2000-07-22",57],["2000-07-23",55],["2000-07-24",60]],s=e.map(function(t){return t[0]}),a=e.map(function(t){return t[1]});t.setOption({visualMap:[{show:!1,type:"continuous",seriesIndex:0,min:0,max:400}],title:[{left:"center",text:"用户增长图"}],grid:{left:"3%",right:"4%",bottom:"5%",containLabel:!0},tooltip:{trigger:"axis"},xAxis:[{data:s}],yAxis:[{name:"人数",splitLine:{show:!1}}],series:[{type:"line",showSymbol:!1,data:a}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/user/tendency",{params:{startDate:"2018-04-26",endDate:(new Date).Format("yyyy-MM-dd"),interval:1}}).then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=[],n=0;B()(a).forEach(function(t){n+=a[t],i.push([t,n])});var o=i.map(function(t){return t[0]}),r=i.map(function(t){return t[1]});t.setOption({xAxis:[{data:o}],series:[{data:r}]})}})},drawTaskTypeChart:function(){var t=Dt.init(this.$refs.taskTypeChart);t.setOption({title:{text:"任务话题统计",x:"center"},tooltip:{formatter:"{b}: {c}({d}%)"},legend:{show:!0,orient:"horizontal",bottom:0,data:["动物","植物","人类","医学"]},series:[{type:"pie",radius:"55%",data:[{value:200,name:"动物"},{value:30,name:"植物"},{value:12,name:"人类"},{value:56,name:"医学"}]}]}),window.addEventListener("resize",function(){t.resize()}),this.$ajax.get("/statistics/taskPublisher/taskType").then(function(e){var s=e.data;if(0===s.code){var a=s.data,i=B()(a),n=[];i.forEach(function(t){n.push({name:t,value:a[t]})}),t.setOption({legend:{data:i},series:[{data:n}]})}})}},mounted:function(){this.drawUserGrowthChart(),this.drawUserChart(),this.drawTaskChart(),this.drawTaskTypeChart()}},Mt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"sys-state"},[e("el-row",{attrs:{gutter:50}},[e("el-col",{attrs:{span:9}},[e("el-card",{staticClass:"user-amount"},[e("div",{ref:"userChart",staticStyle:{width:"100%",height:"275px"},attrs:{id:"userChart"}})])],1),this._v(" "),e("el-col",{attrs:{span:15}},[e("el-card",[e("div",{ref:"userGrowthChart",staticStyle:{width:"100%",height:"275px"}})])],1)],1),this._v(" "),e("el-row",{attrs:{gutter:50}},[e("el-col",{attrs:{span:9}},[e("el-card",[e("div",{ref:"taskTypeChart",staticStyle:{width:"100%",height:"275px"}})])],1),this._v(" "),e("el-col",{attrs:{span:15}},[e("el-card",[e("div",{ref:"taskChart",staticStyle:{width:"100%",height:"275px"}})])],1)],1)],1)},staticRenderFns:[]};var Ot=s("VU/8")(Ft,Mt,!1,function(t){s("S4g0")},null,null).exports,Wt={components:{TaskCard:ht},name:"home-view",data:function(){return{hotTaskIndex:0,recommendTasks:[],hotTasks:[{title:"默认标题"}],latestTasks:[],fullscreenLoading1:!1,fullscreenLoading2:!1}},mounted:function(){this.getHotTasks(),this.getRecommendTasks(),this.getLatestTasks()},methods:{getBanner:function(t){return t?"/show/"+t.id+"/"+t.picName:"/static/image/default_banner.jpg"},clickTitle:function(t){this.$refs.carousel.setActiveItem(t)},changeCarousel:function(t,e){this.hotTaskIndex=t},getLatestTasks:function(){var t=this;this.$ajax.get("/user/tasks/search",{params:{userId:Number(this.$store.getters.id),keyword:"",sortBy:"时间",isSec:!0,size:9,topics:[].join(","),page:1}}).then(function(e){var s=(e=e.data).data;t.latestTasks=s.data}).catch(function(){t.$message.error("获取最新任务失败")}).finally(function(){t.fullscreenLoading=!1})},getRecommendTasks:function(){var t=this;this.fullscreenLoading1=!0,this.$ajax.get("/recommend/user",{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code?t.recommendTasks=s.data:t.$message.error(s.message)}).finally(function(){t.fullscreenLoading1=!1})},getHotTasks:function(){var t=this;this.fullscreenLoading2=!0,this.$ajax.get("/recommend/hotTask",{params:{userId:this.$store.getters.id}}).then(function(e){var s=e.data;0===s.code?t.hotTasks=s.data:t.$message.error(s.message)}).finally(function(){t.fullscreenLoading2=!1})},enterTask:function(){localStorage.setItem("taskInfo",y()(this.hotTasks[this.hotTaskIndex])),localStorage.setItem("taskState","new"),this.$router.push("/task-detail")},removeRecommend:function(t){console.log(t);for(var e=0;e<this.recommendTasks.length;e++)if(console.log(this.recommendTasks[e]),this.recommendTasks[e].id===Number(t)){this.recommendTasks.splice(e,1);break}}}},jt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading1||t.fullscreenLoading2,expression:"fullscreenLoading1 || fullscreenLoading2",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"home-view"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.hotTasks.length>0,expression:"hotTasks.length > 0"}],staticClass:"hot-task-wrapper"},[s("el-carousel",{ref:"carousel",staticClass:"hot-task",attrs:{height:"400px","indicator-position":"none",arrow:"never"},on:{change:t.changeCarousel}},[t._l(t.hotTasks,function(e,a){return s("el-carousel-item",{key:a},[s("div",{staticClass:"carousel-item"},[s("img",{attrs:{src:t.getBanner(e),width:"100%"},on:{click:t.enterTask}})])])}),t._v(" "),s("div",{staticClass:"task-info"},t._l(t.hotTasks,function(e,a){return s("h1",{key:a,staticClass:"title",class:{active:a===t.hotTaskIndex},on:{click:function(e){t.clickTitle(a)}}},[t._v(t._s(e.title))])}))],2)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.latestTasks.length>0,expression:"latestTasks.length > 0"}],staticClass:"latest-wrapper"},[s("h1",{staticClass:"header"},[t._v("最新任务")]),t._v(" "),s("div",{staticClass:"card-content"},[t._l(t.latestTasks,function(t,e){return s("div",{key:e+7,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":t,state:"new"}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e+20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])})],2)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.recommendTasks.length>0,expression:"recommendTasks.length > 0"}],staticClass:"recommend-wrapper"},[s("h1",{staticClass:"header"},[t._v("猜你喜欢")]),t._v(" "),s("div",{staticClass:"card-content"},[t._l(t.recommendTasks,function(e,a){return s("div",{key:a,staticClass:"task-card-wrapper"},[s("task-card",{attrs:{"task-info":e,state:"new","in-recommend":!0},on:{notlike:t.removeRecommend}})],1)}),t._v(" "),t._l(3,function(t,e){return s("div",{key:e+20,staticClass:"task-card-wrapper"},[s("div",{staticClass:"empty"})])}),t._v(" "),s("div",{staticClass:"link"},[t._v("没有喜欢的任务？去\n        "),s("router-link",{attrs:{to:"/tasks"}},[t._v("任务中心")]),t._v("\n        看看吧\n      ")],1)],2)])])},staticRenderFns:[]};var Vt=s("VU/8")(Wt,jt,!1,function(t){s("MzPN")},null,null).exports,Bt={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"white-page"})},staticRenderFns:[]};var qt=s("VU/8")({name:"white-page"},Bt,!1,function(t){s("SX+A")},null,null).exports,Ht={name:"alipay",mounted:function(){var t=this,e=this.getQueryString("out_trade_no");this.$ajax.get("/alipay/detail/"+e).then(function(e){var s=e.data;if(0===s.code){var a=s.data;t.$ajax.get("/user/info/"+a.userId).then(function(e){var s=e.data;if(0===s.code){var a=s.data,i={userId:a.id,username:a.username,userType:a.userType,avatar:a.avatar};t.userLogin(i),t.$router.push("/user")}})}})},methods:f()({},Object(i.c)({userLogin:"login"}),{getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),s=window.location.href,a=s.substr(s.indexOf("?")).match(e);return null!=a?decodeURIComponent(a[2]):null}})},Xt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"alipay"},[e("div",{ref:"content"},[this._v("hhh")])])},staticRenderFns:[]};var Yt=s("VU/8")(Ht,Xt,!1,function(t){s("kl8+")},null,null).exports,Qt=s("lbHh"),Gt=s.n(Qt),Zt={name:"signin",data:function(){return{name:"",password:""}},methods:f()({},Object(i.c)({userLogin:"login"}),{login:function(){var t=this;this.$ajax.post("/user/login",{name:this.name,password:this.password}).then(function(e){var s=e.data;0===s.status?(Gt.a.set("login-token",s.result),t.$ajax.get("/user/loginByToken",{params:{name:t.name,password:t.password}}).then(function(e){if(0===(e=e.data).code){var s=e.data,a={userId:s.id,username:s.username,userType:s.userType,avatar:s.avatar};switch(t.userLogin(a),t.$store.getters.userType){case 0:t.$router.push("/home-view");break;case 1:t.$router.push("/myTasks");break;case 2:t.$router.push("/admin")}}})):t.$message.error("登录失败")})}})},Jt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-form",{staticClass:"login-form"},[s("el-form-item",[s("el-input",{staticClass:"username-input",attrs:{placeholder:"手机号/邮箱"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-input",{staticClass:"password-input",attrs:{placeholder:"密码",type:"password"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"login-btn",attrs:{type:"primary",round:""},on:{click:t.login}},[t._v("登录")])],1)],1)},staticRenderFns:[]};var Kt=s("VU/8")(Zt,Jt,!1,function(t){s("xj+q")},null,null).exports,te={name:"sign",data:function(){var t=this;return{step:1,topicList:["动物","植物","车辆","船舶","运动","美食","IT","机械","医学","人类"],signUpForm:{username:"",password:"",passwordAgain:"",phone:"",email:"",userType:0,topics:[]},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符"},{pattern:/^[a-zA-Z](\w){1,9}$/,message:"以字母开头，长度在2-10之间， 只能包含字符、数字和下划线"}],password:[{validator:function(e,s,a){""===s?a(new Error("请输入密码")):(""!==t.signUpForm.password&&t.$refs.signUpForm.validateField("passwordAgain"),a())},trigger:"blur"}],passwordAgain:[{validator:function(e,s,a){""===s?a(new Error("请再次输入密码")):s!==t.signUpForm.password?a(new Error("两次输入密码不一致!")):a()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur,change"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:function(t,e,s){!1===/^1[34578]\d{9}$/.test(e)?s(new Error("请输入正确的手机号")):s()},trigger:"blur"}],userType:[{required:!0}]}}},methods:{chooseTopic:function(t){var e=t.target,s=e.textContent;this.signUpForm.topics.some(function(t){return t===s})?(this.signUpForm.topics.splice(this.signUpForm.topics.indexOf(s),1),e.style.background="hsla(220,4%,58%,.1)",e.style.borderColor="hsla(220,4%,58%,.2)",e.style.color="#909399"):(this.signUpForm.topics.push(s),e.style.background="rgba(64,158,255,.1)",e.style.border="1px solid rgba(64,158,255,.2)",e.style.color="#409eff")},nextStep:function(){this.validate()?this.step=2:this.$message.error("先填完步骤一信息，才能进入步骤二哦！")},sign:function(){var t=this;this.validate()&&this.$ajax.post("/user/sign",this.signUpForm).then(function(e){switch(e.data.code){case 0:t.$router.push("/home"),t.$message.success("注册成功");break;case 6:case 7:t.$message.error("注册失败!"+e.message)}})},validate:function(){var t=void 0;for(t in this.signUpForm)if(""===this.signUpForm[t]&&"userType"!==t)return!1;return!0}}},ee={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-steps",{attrs:{space:200,active:t.step,"finish-status":"success","align-center":!0,simple:!0}},[s("el-step",{attrs:{title:"步骤 1"}}),t._v(" "),s("el-step",{attrs:{title:"步骤 2"}})],1),t._v(" "),s("el-form",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],ref:"signUpForm",staticClass:"sign-form",attrs:{"status-icon":"",rules:t.rules,model:t.signUpForm}},[s("el-form-item",{attrs:{prop:"username"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.signUpForm.username,callback:function(e){t.$set(t.signUpForm,"username",e)},expression:"signUpForm.username"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:t.signUpForm.password,callback:function(e){t.$set(t.signUpForm,"password",e)},expression:"signUpForm.password"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"passwordAgain"}},[s("el-input",{attrs:{placeholder:"请再次输入密码",type:"password"},model:{value:t.signUpForm.passwordAgain,callback:function(e){t.$set(t.signUpForm,"passwordAgain",e)},expression:"signUpForm.passwordAgain"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"phone"}},[s("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:t.signUpForm.phone,callback:function(e){t.$set(t.signUpForm,"phone",e)},expression:"signUpForm.phone"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",{attrs:{prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮件地址"},model:{value:t.signUpForm.email,callback:function(e){t.$set(t.signUpForm,"email",e)},expression:"signUpForm.email"}},[s("i",{staticClass:"iconfont",attrs:{slot:"prefix"},slot:"prefix"},[t._v("")])])],1),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"next-btn",attrs:{type:"primary",round:""},on:{click:t.nextStep}},[t._v("下一步")])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"user-detail-info-card"},[s("el-form",{attrs:{model:t.signUpForm}},[s("el-form-item",{attrs:{label:"我是"}},[s("el-radio-group",{staticClass:"choice",model:{value:t.signUpForm.userType,callback:function(e){t.$set(t.signUpForm,"userType",e)},expression:"signUpForm.userType"}},[s("el-radio",{attrs:{label:0}},[t._v("众包工人")]),t._v(" "),s("el-radio",{attrs:{label:1}},[t._v("众包发起者")])],1)],1),t._v(" "),s("el-form-item",[s("div",{staticClass:"topic-title",staticStyle:{color:"#606266"}},[t._v("我的兴趣是")]),t._v(" "),s("ul",{staticClass:"topic-content"},t._l(t.topicList,function(e,a){return s("li",{key:a,ref:"topics",refInFor:!0,staticClass:"topic-tag"},[s("el-tag",{attrs:{type:"info"},nativeOn:{click:function(e){t.chooseTopic(e)}}},[t._v(t._s(e))])],1)}))]),t._v(" "),s("el-form-item",[s("el-button",{staticClass:"sign-btn",attrs:{type:"primary",round:""},on:{click:t.sign}},[t._v("注册")])],1)],1)],1)],1)},staticRenderFns:[]};var se=s("VU/8")(te,ee,!1,function(t){s("rkZY")},null,null).exports;a.default.use(u.a);var ae=[{path:"/",redirect:"/login"},{path:"/alipay",name:"Alipay",component:Yt},{path:"/white",component:qt},{path:"/admin",component:Et,children:[{path:"/check-task",component:At},{path:"/check-tag",component:Ut},{path:"/system-state",component:Ot}]},{path:"/home",component:k,redirect:"/myTasks",children:[{path:"/publish",component:Z},{path:"/home-view",component:Vt},{path:"/tasks",component:ot},{path:"/user",component:ut},{path:"/myTasks",component:_t},{path:"/task-detail",component:xt},{path:"/rank",component:It}]},{name:"board",path:"/board",component:F},{path:"/login",component:h,children:[{path:"/",name:"Login",component:Kt},{path:"/sign",name:"Sign",component:se}]}],ie=new u.a({routes:ae,linkActiveClass:"active"});ie.beforeEach(function(t,e,s){return"Login"===t.name?o.getters.isLogin?s("/home"):s():"Sign"===t.name?s():"Alipay"===t.name?s():o.getters.isLogin?s():s("/login")});var ne=ie,oe=s("mtWM"),re=s.n(oe),le=s("1nuA"),ce=s.n(le),ue=s("zL8q"),de=s.n(ue);s("tvR6");a.default.use(de.a),a.default.prototype.$qs=ce.a,a.default.prototype.$ajax=re.a,a.default.config.productionTip=!1,new a.default({el:"#app",router:ne,components:{App:c},template:"<App/>"})},PyXk:function(t,e){},Raw4:function(t,e){},S4g0:function(t,e){},"SX+A":function(t,e){},Tmu6:function(t,e){},aVWu:function(t,e){},bHyx:function(t,e){},dCXo:function(t,e){},fjIZ:function(t,e){Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[s]:("00"+e[s]).substr((""+e[s]).length)));return t}},"kl8+":function(t,e){},lWb7:function(t,e){},nc7f:function(t,e){},peNL:function(t,e){},rAI6:function(t,e){},rkZY:function(t,e){},tvR6:function(t,e){},"xj+q":function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.7e402ae5c90dab704494.js.map